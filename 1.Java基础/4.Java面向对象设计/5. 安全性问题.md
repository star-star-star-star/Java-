有些编程语言被称为“类型安全”语言，但程序员使用这个术语时要表达的意思却很宽松。“类型安全”有很多解读和定义方式，而且各种方式之间并不都有关联。对我们要讨论的话题来说，类型安全最适合解释为编程语言的一个属性，其作用是避免运行时把数据识别为错误的类型。类型安全与否是相对的，正确的解释方式应该是，一门语言比（或没有）另一门语言安全，而不能直接断定一门语言是绝对安全或绝对不安全的。

Java的类型系统是静态的，能避免很多问题，例如，如果程序员试图把不兼容的值赋值给变量，会导致编译出错。但是，Java的类型安全并不完美，因为任何两种引用类型之间都可以通过校正相互转换——如果值之间不兼容，这种转换在运行时会失败，抛出 ClassCastException 异常。

本书所说的安全性和更宽泛的正确性分不开，也就是说，我们要站在程序的角度，而不是语言的角度来探讨安全性。这强调了一个问题，即代码的安全不是由任何一门广泛使用的语言决定的，而要由程序员付出足够的努力（并严格遵守编程准则），确保写出的代码真正安全且正确。

为了得到安全的程序，我们使用下图的抽象状态模型：

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 829.5000066757202 476.3028551079333" width="829.5000066757202" height="476.3028551079333">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://www.iodraw.com/whiteboard/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://www.iodraw.com/whiteboard/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="829.5000066757202" height="476.3028551079333" fill="#ffffff"></rect><g stroke-linecap="round"><g transform="translate(157 42) rotate(0 -0.00834741410314166 211.77322785329076)"><path d="M0.52 0.19 C0.71 70.65, 0.65 352.51, 0.62 422.9 M-0.67 -0.76 C-0.54 69.88, -0.07 353.6, 0 424.3" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(10 147.5) rotate(0 49.5 49.5)"><path d="M0 0 L99 0 L99 99 L0 99" stroke="none" stroke-width="0" fill="#fff"></path><path d="M0 0 C30.97 0, 61.94 0, 99 0 M0 0 C25.1 0, 50.19 0, 99 0 M99 0 C99 31.86, 99 63.72, 99 99 M99 0 C99 33.54, 99 67.08, 99 99 M99 99 C72.74 99, 46.48 99, 0 99 M99 99 C67.02 99, 35.03 99, 0 99 M0 99 C0 62.07, 0 25.15, 0 0 M0 99 C0 69.93, 0 40.86, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(200 156) rotate(0 42 41)"><path d="M1.49 1.15 C19.83 0.1, 34.23 2.3, 83.61 1.03 M0.79 -0.63 C24.12 -0.59, 46.62 0.18, 83.97 -0.39 M83.3 -1.22 C84.9 16.08, 85.02 34.09, 83.99 83.49 M84.67 -0.87 C83.63 28.39, 84.33 56.95, 83 82.08 M84.53 81.52 C59.79 80.82, 33.27 83.22, -0.2 83.07 M83.74 82.68 C50.87 80.76, 19.28 80.22, 0.77 81.18 M0.56 80.44 C1.68 52.93, -0.75 23.53, 0.12 -1.08 M0.67 81.84 C0.12 62.87, -0.33 43.19, -0.9 -0.62" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(205 176) rotate(0 35.37963412725365 -0.28501357743658673)"><path d="M-0.53 0.34 C10.87 0.61, 57.3 0.78, 69.07 0.58 M1.39 -0.53 C13.1 -0.53, 59.96 -1.32, 71.29 -1.24" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(204 192) rotate(0 34.78704842142761 -0.18564926795659176)"><path d="M-1.19 0.81 C10.74 0.79, 58.98 -1.04, 70.76 -1.18 M0.39 0.18 C12.29 0.37, 58.87 -0.44, 70.21 -0.26" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(204 210) rotate(0 35.502505737636255 0.18781378868780507)"><path d="M0.71 0.83 C12.12 1.06, 57.58 0.98, 69.12 0.99 M-0.37 0.23 C11.35 0.16, 59.78 -0.42, 71.38 -0.62" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-opacity="0.3" fill-opacity="0.3" stroke-linecap="round" transform="translate(266 10) rotate(0 42 41)"><path d="M-0.12 -1.99 C25.92 0.81, 47.88 -2.12, 85.45 -0.57 M0.61 0.56 C19.22 -0.03, 39.9 -0.86, 84.4 -0.35 M82.82 1.73 C83.78 19.77, 83.72 43.4, 82.11 80.47 M83.21 -0.07 C84.57 26.95, 83.06 52.87, 84.42 81.22 M82.43 83.24 C66.94 84.43, 48.45 81.08, -1.27 83.03 M83.73 82.32 C62.66 81.18, 39.93 81.59, 0.31 81.09 M-0.32 80.28 C-0.02 65.76, -1.41 46.33, -1.22 0.07 M-0.84 81.81 C0.22 50.41, 1.32 16.18, -0.97 -0.21" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(271 30) rotate(0 34.59512789496219 -0.19789573305286723)"><path d="M-0.07 -1.19 C11.79 -1.18, 59.22 0.74, 70.76 0.78 M-1.57 0.8 C10.23 0.41, 58.02 -0.77, 70.21 -0.93" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(270 46) rotate(0 34.79435998015106 -0.049398128315800705)"><path d="M-1.19 0.76 C10.49 0.63, 59.08 -0.88, 70.78 -0.86 M0.38 0.11 C11.91 0.12, 58.41 0.42, 70.24 0.23" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(270 64) rotate(0 35.551075757835065 -0.09705193229018505)"><path d="M0.76 0.78 C12.3 0.82, 57.46 -0.79, 69.14 -0.97 M-0.3 0.15 C11.62 0.4, 59.59 -0.06, 71.4 0.05" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(434 42) rotate(0 42 41)"><path d="M-1.56 0.61 C22.8 1.31, 48.76 0.99, 85.78 -1.33 M0.91 0.55 C32.62 -0.9, 66.98 -0.74, 84.57 0.9 M83.55 1.14 C84.96 33.44, 83.51 67.1, 82.16 80.23 M84.15 0.48 C84.63 20.49, 83.47 43.32, 83.8 82.42 M83.25 83.41 C64.31 81.9, 45.8 83.64, 0.85 82.22 M83.42 81.38 C55.44 81.55, 28.01 81.1, 0.8 81.33 M-1.8 80.61 C-1.34 58.62, -0.08 31.99, 1.97 0.12 M0.29 81.45 C0.5 49.83, -0.25 18.62, -0.56 -0.59" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(439 62) rotate(0 35.27950909100471 -0.5907560913366012)"><path d="M-0.94 0.37 C10.69 0.6, 57.33 0.38, 69.2 0.34 M0.77 -0.49 C12.84 -0.54, 60.01 -1.94, 71.5 -1.6" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(438 78) rotate(0 34.7206560175959 -0.13705806830897416)"><path d="M0.37 -0.8 C12.26 -0.59, 58.71 -0.02, 70.34 0.3 M-0.9 1.4 C10.96 1.31, 57.85 -1.32, 69.58 -1.67" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(438 96) rotate(0 34.74887296967211 0.622767190709709)"><path d="M-0.8 0.34 C11.07 0.31, 58.32 0.34, 70.3 0.15 M0.98 -0.52 C12.81 -0.37, 57.86 1.66, 69.5 1.77" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-opacity="0.3" fill-opacity="0.3" stroke-linecap="round" transform="translate(340 192) rotate(0 42 41)"><path d="M-0.58 0.21 C27.35 1.78, 54.03 -0.35, 83.52 1.48 M-0.85 -0.37 C18.44 1.24, 36.9 1.3, 83.37 -0.93 M84.03 -1.1 C83.6 29.64, 84.71 54.75, 85.02 83.86 M84.64 0.04 C83.76 27.66, 83.5 56.69, 83.83 82.87 M85.26 81.31 C62.52 83.37, 45.15 82.01, 0.11 80.17 M83.74 81.41 C66.16 81.09, 45.96 82.93, -0.87 81.32 M1.02 82.15 C1.36 63.39, 0.84 42.14, -0.73 -0.73 M0.72 81.36 C0.43 50, -0.02 17.29, -0.03 -0.49" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(345 212) rotate(0 34.67686262913048 0.12493323988638849)"><path d="M-0.35 0.13 C11.31 0.29, 58.14 1.19, 69.7 1.15 M1.67 -0.85 C13.16 -1.01, 56.98 -0.7, 68.59 -0.38" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(344 228) rotate(0 34.93971976436674 -0.7538233961909953)"><path d="M0.13 -0.3 C11.96 -0.41, 59.52 -1.01, 71.15 -1.01 M-1.27 -1.5 C10.49 -1.47, 59.08 -0.4, 70.8 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(344 246) rotate(0 35.43513218828477 0.6223350937756322)"><path d="M-0.3 1.15 C11.26 1.1, 57.32 -0.1, 68.99 -0.14 M1.74 0.7 C13.69 0.84, 60 1.61, 71.17 1.33" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(530 168) rotate(0 42 41)"><path d="M-0.97 -1.19 C26.53 2.34, 56.82 0.06, 85.31 1.32 M-0.23 0.82 C31.59 -0.4, 63.31 0.46, 84.16 -0.82 M84.53 0.28 C85.53 19, 83.64 35.86, 84.87 80.13 M83.84 -0.53 C84.23 29.47, 83.54 56.89, 84.54 81.78 M82.61 82.02 C55.69 79.97, 28.98 80.99, -1.89 81.37 M83.75 82.19 C63.1 81.47, 41.25 82.06, -0.8 82 M1.56 80.67 C1.18 63.09, 0.69 41.87, 0.71 -0.97 M-0.99 81.93 C0.28 56.56, 1.02 31.28, 0.48 0.32" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(535 188) rotate(0 35.440088232532105 0.4089292182773363)"><path d="M-0.58 -0.71 C10.98 -0.37, 57.31 0.89, 69.18 0.94 M1.31 1.53 C13.27 1.64, 59.98 -0.55, 71.46 -0.69" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(534 204) rotate(0 35.11383027620616 0.09533634116874623)"><path d="M-0.71 -0.82 C11.3 -0.62, 59.23 0.35, 70.94 0.62 M1.12 1.37 C13.14 1.27, 59.24 -0.76, 70.48 -1.18" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(534 222) rotate(0 34.90126274637879 0.26079633593380436)"><path d="M-0.82 0.94 C11.05 0.99, 58.69 -0.41, 70.62 -0.43 M0.95 0.39 C12.77 0.66, 58.42 1.13, 70 0.88" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(276 327) rotate(0 42 41)"><path d="M1.13 -0.74 C35.05 -1.28, 67.66 -0.93, 83.16 1.03 M0.79 0.5 C19.21 -0.71, 37.44 -1.3, 83.95 0.19 M82.83 0.31 C82.48 24.6, 82.71 53.72, 85.16 82.47 M83.05 -0.5 C83.11 20.45, 84.15 38.73, 84.17 82.97 M85.32 82.01 C53.18 80.53, 20.7 80.78, -0.64 83.86 M84.92 81.16 C52.53 80.99, 20.83 80.47, -0.33 82.63 M-0.76 80.62 C-0.48 62.36, 1.82 44.15, -1.2 -1.21 M-0.89 82.26 C1.59 50.41, 0.22 19.76, 0.18 0.35" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(281 347) rotate(0 35.29978862323799 -0.8894211346842553)"><path d="M0.68 -0.44 C12.46 -0.51, 59.38 -0.98, 71.03 -1.05 M-0.43 -1.72 C11.26 -1.61, 58.86 -0.35, 70.62 -0.06" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(280 363) rotate(0 35.33673132650554 -0.09213825099169526)"><path d="M-0.44 1.03 C11.16 1.02, 57.35 0.85, 68.95 0.6 M1.53 0.52 C13.55 0.1, 59.43 -1.22, 71.12 -1.21" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(280 381) rotate(0 35.35320336961186 -0.025166955801608992)"><path d="M1.03 -1.05 C12.68 -1.11, 59.19 -1.12, 70.6 -0.84 M0.11 1.02 C11.6 1.12, 58.57 0.66, 69.96 0.26" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(245 144) rotate(0 18.782071419432754 -18.333489839369435)"><path d="M-1 -0.8 C5.3 -7.13, 32.05 -31.99, 38.56 -38.06 M0.68 1.39 C6.79 -4.72, 31.79 -29.79, 37.91 -36.55" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(245 144) rotate(0 18.782071419432754 -18.333489839369435)"><path d="M25.77 -11.02 C30.98 -20.72, 36.32 -31.03, 36.06 -36.21 M27.25 -12.58 C30.71 -18.89, 32.72 -26.27, 38.41 -37.33" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(245 144) rotate(0 18.782071419432754 -18.333489839369435)"><path d="M12.48 -23.72 C22.56 -28.66, 32.76 -34.32, 36.06 -36.21 M13.97 -25.28 C21.29 -27.86, 27.25 -31.47, 38.41 -37.33" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(355 43) rotate(0 36.5039037745446 21.44549870856106)"><path d="M0.82 0.78 C12.51 7.94, 59.33 36.07, 71.02 42.74 M-0.21 0.15 C11.77 6.98, 60.96 34.11, 73.22 41.01" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(355 43) rotate(0 36.5039037745446 21.44549870856106)"><path d="M44.9 34.63 C55.84 36.12, 63.69 41.54, 72.69 42.59 M43.34 35.73 C53.11 37.49, 63.86 38.5, 72.55 41.61" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(355 43) rotate(0 36.5039037745446 21.44549870856106)"><path d="M54.89 16.7 C62.08 24.92, 66.22 37.01, 72.69 42.59 M53.32 17.8 C59.7 25.6, 67.12 32.58, 72.55 41.61" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(329 99) rotate(0 25.360924190077924 42.701579251792296)"><path d="M1.07 0.06 C9.27 14.38, 40.27 70.92, 48.24 84.89 M0.17 -0.96 C8.85 13.65, 42.56 72.11, 50.55 86.36" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(329 99) rotate(0 25.360924190077924 42.701579251792296)"><path d="M27.77 65.69 C32.3 70.82, 35.56 74.71, 49.91 86.75 M27.34 67.22 C35.42 73.99, 41.55 79.97, 50.6 85.5" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(329 99) rotate(0 25.360924190077924 42.701579251792296)"><path d="M45.6 55.52 C46.15 63.03, 45.53 69.13, 49.91 86.75 M45.17 57.05 C47.71 66.97, 48.31 76.1, 50.6 85.5" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(290 197) rotate(0 24.111998840048898 24.180381612842893)"><path d="M-0.75 -0.52 C7.52 7.56, 40.77 39.8, 48.97 47.92 M1.06 1.81 C9.23 10.06, 40.29 41.02, 48.01 48.89" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(290 197) rotate(0 24.111998840048898 24.180381612842893)"><path d="M19.98 36.07 C25.66 38.48, 32.74 41.68, 47.72 47.1 M20.1 35.7 C26.83 40.01, 33.1 41.07, 48.19 49.55" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-opacity="0.3" fill-opacity="0.3" transform="translate(290 197) rotate(0 24.111998840048898 24.180381612842893)"><path d="M34.54 21.61 C36.57 27.48, 40.07 34.24, 47.72 47.1 M34.66 21.24 C38.22 28.64, 41.32 32.85, 48.19 49.55" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(251 246) rotate(0 22.166741301650177 39.46937195590698)"><path d="M0.23 0.74 C7.69 13.97, 38.08 65.87, 45.43 78.85 M-1.1 0.09 C6.17 13.02, 37.33 64.42, 44.71 77.18" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(251 246) rotate(0 22.166741301650177 39.46937195590698)"><path d="M22.74 58.9 C31.18 63.85, 39.18 73.17, 44.94 76.25 M20.8 58.21 C27.93 63.03, 34.81 69.24, 44.35 77.4" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(251 246) rotate(0 22.166741301650177 39.46937195590698)"><path d="M40.38 48.42 C42.44 57.17, 44.1 70.25, 44.94 76.25 M38.45 47.73 C40.28 55.6, 41.88 64.95, 44.35 77.4" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(360 279) rotate(0 -9.906768825259064 19.577151640420766)"><path d="M-0.48 1.1 C-3.86 7.43, -17.15 32.28, -20.91 38.52 M1.47 0.64 C-1.92 6.55, -17.59 30.7, -21.29 36.67" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(360 279) rotate(0 -9.906768825259064 19.577151640420766)"><path d="M-14.73 17.04 C-16.78 18.82, -17.98 25.79, -21.18 35.19 M-17.1 15.21 C-17.9 21.74, -19.12 30.47, -22.09 36.01" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(360 279) rotate(0 -9.906768825259064 19.577151640420766)"><path d="M-2.05 25.1 C-7.32 24.8, -11.7 29.76, -21.18 35.19 M-4.42 23.27 C-9.62 27.02, -15.19 32.99, -22.09 36.01" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(365 377) rotate(0 104.99419972486791 -61.18883771905675)"><path d="M-0.46 -1.19 C34.78 -21.29, 175.36 -101.36, 210.45 -121.38 M1.5 0.8 C36.61 -19.58, 174.05 -102.49, 209.21 -123.18" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(365 377) rotate(0 104.99419972486791 -61.18883771905675)"><path d="M188.27 -100.84 C195.6 -106.5, 199.85 -108.58, 210.71 -122.7 M191.14 -100.02 C195.13 -106.65, 200.99 -114.25, 209.28 -123.4" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(365 377) rotate(0 104.99419972486791 -61.18883771905675)"><path d="M177.76 -118.47 C187.28 -120.22, 193.84 -118.42, 210.71 -122.7 M180.62 -117.65 C187.48 -119.35, 196.34 -121.93, 209.28 -123.4" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(432 250) rotate(0 45.71953021101652 -12.493794978782546)"><path d="M-0.73 -0.72 C14.53 -4.92, 76.68 -20.36, 92.16 -24.59 M1.09 1.51 C16.15 -3.11, 76.23 -22.01, 91.3 -26.5" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(432 250) rotate(0 45.71953021101652 -12.493794978782546)"><path d="M66.17 -8.14 C76.4 -14.35, 82.27 -23.03, 91.49 -25.16 M68.05 -9.1 C75.72 -14.31, 81.61 -19.92, 91.25 -27.42" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(432 250) rotate(0 45.71953021101652 -12.493794978782546)"><path d="M60.14 -27.75 C72.6 -27.01, 80.59 -28.77, 91.49 -25.16 M62.02 -28.71 C71.74 -27.75, 79.53 -27.17, 91.25 -27.42" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(510 129) rotate(0 27.27792447619143 15.792390235140914)"><path d="M-0.53 -1 C8.52 4.54, 45.96 27.23, 55.09 32.58 M1.39 1.09 C10.22 6.33, 44.96 25.62, 54.18 30.76" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(510 129) rotate(0 27.27792447619143 15.792390235140914)"><path d="M22.9 26.15 C36.31 26.62, 44.68 28.65, 55.23 30.07 M24.73 26.1 C32.63 26.94, 39.36 28.51, 53.81 31.54" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(510 129) rotate(0 27.27792447619143 15.792390235140914)"><path d="M32.89 8.23 C42.56 15.19, 47.29 23.75, 55.23 30.07 M34.72 8.17 C39.83 13.85, 43.9 20.18, 53.81 31.54" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(119 194) rotate(0 36.08079742886126 0.5497582726997052)"><path d="M1.13 -0.7 C13.17 -0.58, 60.42 -0.32, 71.9 -0.08 M0.26 1.55 C12.26 1.94, 59.4 1.87, 71.43 1.41" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(119 194) rotate(0 36.08079742886126 0.5497582726997052)"><path d="M42.24 13.64 C50.87 7.42, 59.75 6.97, 70.83 0.91 M44.08 12.09 C52.52 8.58, 62.3 4.59, 71.44 1.77" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(119 194) rotate(0 36.08079742886126 0.5497582726997052)"><path d="M41.9 -6.87 C50.48 -7.6, 59.46 -2.55, 70.83 0.91 M43.74 -8.43 C52.29 -5.39, 62.17 -2.82, 71.44 1.77" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(659.0000019073486 38) rotate(0 0.04237714095154388 213.34335278571584)"><path d="M0.93 -0.23 C1.06 70.96, 0.16 355.27, 0.06 426.55 M-0.04 -1.4 C0 70.05, -0.82 356.93, -0.85 428.09" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(720.5000066757202 158.5) rotate(0 49.5 49.5)"><path d="M0 0 L99 0 L99 99 L0 99" stroke="none" stroke-width="0" fill="#fff"></path><path d="M0 0 C32.71 0, 65.41 0, 99 0 M0 0 C38.12 0, 76.23 0, 99 0 M99 0 C99 30.28, 99 60.57, 99 99 M99 0 C99 23.42, 99 46.84, 99 99 M99 99 C76.2 99, 53.4 99, 0 99 M99 99 C69.26 99, 39.52 99, 0 99 M0 99 C0 71.11, 0 43.21, 0 0 M0 99 C0 73.71, 0 48.42, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(738.5000066757202 177) rotate(0 32.73844121508296 30.21331162042918)"><path d="M-0.73 -0.81 C10.22 9.2, 55.17 49.67, 66.21 59.8 M1.09 1.37 C11.86 11.6, 54.8 51.24, 65.37 61.24" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(732.5000066757202 243) rotate(0 35.47036309891382 -33.38586252876556)"><path d="M-0.41 -0.75 C10.92 -12.32, 57.41 -57.17, 69.11 -68.25 M1.58 1.47 C13.18 -9.4, 60.13 -55.07, 71.35 -66.84" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(620.5000066757202 209) rotate(0 48.56065548920077 0.23369692313275436)"><path d="M-0.43 -0.82 C15.33 -0.82, 79.25 -1.08, 95.24 -0.81 M1.55 1.37 C17.63 1.57, 82.07 0.72, 97.55 0.3" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(620.5000066757202 209) rotate(0 48.56065548920077 0.23369692313275436)"><path d="M68.19 9.81 C78.34 6.43, 91.07 3.96, 96.82 2.27 M70.22 10.86 C80.08 7.95, 91.45 3.18, 97.15 -0.7" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(620.5000066757202 209) rotate(0 48.56065548920077 0.23369692313275436)"><path d="M67.81 -10.71 C77.96 -6.71, 90.83 -1.8, 96.82 2.27 M69.84 -9.65 C79.65 -4.66, 91.15 -1.53, 97.15 -0.7" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(27.333335399627686 436.33333456516266) rotate(0 30.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">创建期</text></g><g transform="translate(375.66666972637177 439.33333456516266) rotate(0 30.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">生存期</text></g><g transform="translate(734.1666814088821 435.33333456516266) rotate(0 30.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">死亡期</text></g></svg>

安全的程序具有以下特征：
+ 所有对象在创建后都处于一种合法状态；
+ 外部可访问的方法在合法状态之间转换对象；
+ 外部可访问方法绝对不能返回状态不一致的对象；
+ 在弃用对象之前，外部可访问的方法必须把对象还原为合法状态。

其中，“外部可访问”的方法是指声明为 `public` `protected` 或者对包私有的方法。

上述特征为安全的程序定义了一个合理的模型，而且按照这种方式定义的抽象类型，它的方法能保证状态的一致性。满足上述条件的程序就可以称为“安全的程序”，而不用管程序使用何种语言实现。

tip：私有方法不用保证对象在使用前后都处于合法状态，因为私有方法不能在外部代码中调用。

当然了，如果想在大量代码中让状态模型和方法都满足上述特征，需要付出相当多的精力。对Java等语言来说，因为程序员能直接创建由多个线程执行的抢占式多任务程序，所以要付出的精力更多。
