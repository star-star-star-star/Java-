# 线程机制的概念

线程的作用是提供一个轻量级执行单元——虽然比进程小，但仍能执行任何Java代码。一般情况下，对操作系统来说，一个线程是一个完整的执行单元，但仍属于一个进程，进程的地址空间在组成该进程的所有线程之间共享。也就是说，每个线程都可以独立调度，而且有自己的栈和程序计数器，但会和同个进程中的其他线程共享内存和对象。

Java平台从第一版就开始支持多线程编程，并向开发者开放了创建新线程的功能。创建新线程往往很简单，如下所示：

```java
Thread t = new Thread(() -> {System.out.println("Hello,Thread");});
t.start();
```

这段简短的代码创建并启动一个新线程，然后执行lambda表达式的主体，最后退出。lambda表达式其实会被转换成Runnable接口的实例，然后再传给Thread类的构造方法。

线程机制允许新线程和原有的应用线程以及JVM为了不同目的而创建多个线程一起并发运行。

tip：在大多数Java平台的实现中，应用线程都能访问操作系统调度程序控制的CPU。调度程序是操作系统原生的一部分，用于管理处理器时间的时间片（也能禁止应用线程超出分配给它的时间）。

在最近几版Java中，越来越流行使用运行时管理的并发。因为基于很多原因，由开发者自行管理线程已经不能满足需求了。而运行时应该提供“发后不理”能力，让程序指定需要做什么，但怎么做这样的低层细节交给运行时完成。

# 线程的生命周期

不同的操作系统看待线程的视角有所不同，因此在某些细节上可能有所不同（不过，站在一定高度上，大多数情况下基本类似）。Java做了很多工作，力求把这些细节抽象化。Java提供了一个名为 Thread.State 的枚举类型，囊括了操作系统看到的线程状态。Thread.State中的值概述了一个线程的生命周期。

线程状态：
+ NEW：已经创建线程，但还没有在线程对象上调用 `start()` 方法。所有线程一开始都处于这个状态。
+ RUNNABLE：线程正在运行，或者当操作系统调度线程时可以运行。
+ BLOCKED：线程中止运行，因为它在等待获得一个锁，以便进入声明为 synchronized 的方法或代码块。
+ WAITING：线程中止运行，因为它调用了 `Object.wait()` 或 `Thread.join()` 方法。
+ TIMED_WAITING：线程中止运行，因为它调用了 `Thread.sleep()` 方法，或者调用了 `Object.wait()` 或 `Thread.join()` 方法，而且传入了超时时间。
+ TERMINATED：线程执行完毕。线程对象的 `run()` 方法正常退出，或者抛出了异常。

这些是常见的线程状态（至少对主流操作系统来说如此），线程的生命周期如下图所示：

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1178.3333475589752 562.499997138977" width="1178.3333475589752" height="562.499997138977">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://www.iodraw.com/whiteboard/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://www.iodraw.com/whiteboard/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="1178.3333475589752" height="562.499997138977" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(460.8809360776622 136.0952331679208) rotate(0 93 37.5)"><path d="M0 0 C59.32 0, 118.65 0, 186 0 M0 0 C43.32 0, 86.63 0, 186 0 M186 0 C186 18.68, 186 37.36, 186 75 M186 0 C186 26.02, 186 52.04, 186 75 M186 75 C118.06 75, 50.11 75, 0 75 M186 75 C115.15 75, 44.3 75, 0 75 M0 75 C0 50.98, 0 26.96, 0 0 M0 75 C0 50.57, 0 26.14, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(465.8809360776622 161.0952331679208) rotate(0 88 13.5)"><text x="88" y="19" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">休眠中</text></g><g stroke-linecap="round" transform="translate(674.8809360776622 136.5952331679208) rotate(0 93 37.5)"><path d="M0 0 C45.26 0, 90.51 0, 186 0 M0 0 C53.78 0, 107.57 0, 186 0 M186 0 C186 28.99, 186 57.98, 186 75 M186 0 C186 22.65, 186 45.31, 186 75 M186 75 C135.72 75, 85.44 75, 0 75 M186 75 C141.97 75, 97.94 75, 0 75 M0 75 C0 52.02, 0 29.04, 0 0 M0 75 C0 45.62, 0 16.24, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(679.8809360776622 160.5952331679208) rotate(0 88 13.5)"><text x="88" y="19" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">等待中</text></g><g stroke-linecap="round" transform="translate(565.8809360776622 294.5952331679208) rotate(0 93 37.5)"><path d="M0 0 C57.04 0, 114.09 0, 186 0 M0 0 C37.52 0, 75.04 0, 186 0 M186 0 C186 27.54, 186 55.07, 186 75 M186 0 C186 28.27, 186 56.53, 186 75 M186 75 C144.46 75, 102.93 75, 0 75 M186 75 C122.5 75, 59 75, 0 75 M0 75 C0 51.25, 0 27.51, 0 0 M0 75 C0 55.97, 0 36.93, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(570.8809360776622 318.5952331679208) rotate(0 88 13.5)"><text x="88" y="19" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">运行中（执行中）</text></g><g stroke-linecap="round" transform="translate(105.71427243096423 291.5952331679208) rotate(0 93 37.5)"><path d="M0 0 C73.95 0, 147.91 0, 186 0 M0 0 C58.11 0, 116.22 0, 186 0 M186 0 C186 23.95, 186 47.91, 186 75 M186 0 C186 20.22, 186 40.45, 186 75 M186 75 C138.33 75, 90.67 75, 0 75 M186 75 C143.51 75, 101.01 75, 0 75 M0 75 C0 46.67, 0 18.33, 0 0 M0 75 C0 46.19, 0 17.37, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(110.71427243096423 315.5952331679208) rotate(0 88 13.5)"><text x="88" y="19" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">准备运行</text></g><g stroke-linecap="round" transform="translate(982.3333475589752 292.16666173934937) rotate(0 93 37.5)"><path d="M0 0 C67.69 0, 135.39 0, 186 0 M0 0 C56.28 0, 112.55 0, 186 0 M186 0 C186 16.65, 186 33.29, 186 75 M186 0 C186 20.69, 186 41.37, 186 75 M186 75 C141.91 75, 97.82 75, 0 75 M186 75 C117.77 75, 49.54 75, 0 75 M0 75 C0 51.27, 0 27.55, 0 0 M0 75 C0 51.52, 0 28.04, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(987.3333475589752 316.16666173934937) rotate(0 88 13.5)"><text x="88" y="19" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">运行完毕</text></g><g stroke-linecap="round" transform="translate(563.333348274231 477.49999713897705) rotate(0 93 37.5)"><path d="M0 0 C64.21 0, 128.43 0, 186 0 M0 0 C43.83 0, 87.66 0, 186 0 M186 0 C186 28.82, 186 57.64, 186 75 M186 0 C186 17.78, 186 35.56, 186 75 M186 75 C120.88 75, 55.77 75, 0 75 M186 75 C129.35 75, 72.69 75, 0 75 M0 75 C0 53.75, 0 32.5, 0 0 M0 75 C0 53.97, 0 32.94, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(568.333348274231 487.99999713897705) rotate(0 88 27)"><text x="88" y="19" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">被IO或同步操作阻</text><text x="88" y="46" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="middle" style="white-space: pre;" direction="ltr">塞</text></g><g transform="translate(10 303.3333387374878) rotate(0 38.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">start();</text></g><g stroke-linecap="round"><g transform="translate(460.00000977516174 175.83333694934845) rotate(0 -100 57)"><path d="M0 0 C-61.7 -0.31, -123.4 -0.62, -198 -1 M0 0 C-54.25 -0.27, -108.51 -0.55, -198 -1 M-198 -1 C-198.55 31.14, -199.11 63.29, -200 115 M-198 -1 C-198.65 36.85, -199.31 74.7, -200 115" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(460.00000977516174 175.83333694934845) rotate(0 -100 57)"><path d="M-209.77 86.64 C-206.73 95.47, -203.68 104.31, -200 115 M-209.77 86.64 C-207.1 94.41, -204.42 102.18, -200 115" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(460.00000977516174 175.83333694934845) rotate(0 -100 57)"><path d="M-189.25 86.99 C-192.6 95.72, -195.95 104.45, -200 115 M-189.25 86.99 C-192.2 94.67, -195.14 102.34, -200 115" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(772.500013589859 132.83333694934845) rotate(0 -301.33333426713943 46)"><path d="M0 0 C0 -24.5, 0 -49, 0 -64 M0 0 C0 -14.12, 0 -28.24, 0 -64 M0 -64 C-199.02 -64.33, -398.05 -64.67, -597.67 -65 M0 -64 C-158.11 -64.26, -316.22 -64.53, -597.67 -65 M-597.67 -65 C-599.47 15.18, -601.28 95.35, -602.67 157 M-597.67 -65 C-599.58 20.1, -601.5 105.19, -602.67 157" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(772.500013589859 132.83333694934845) rotate(0 -301.33333426713943 46)"><path d="M-612.29 128.59 C-608.61 139.46, -604.92 150.34, -602.67 157 M-612.29 128.59 C-610.17 134.85, -608.04 141.12, -602.67 157" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(772.500013589859 132.83333694934845) rotate(0 -301.33333426713943 46)"><path d="M-591.77 129.05 C-595.94 139.75, -600.11 150.45, -602.67 157 M-591.77 129.05 C-594.18 135.21, -596.58 141.38, -602.67 157" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(612.166680932045 10) rotate(0 87.5 25)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Object.notify();</text><text x="0" y="43" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Object.notify.All();</text></g><g stroke-linecap="round"><g transform="translate(603.6666685342789 293.166671872139) rotate(0 0 -40)"><path d="M0 0 C0 -22.76, 0 -45.52, 0 -80 M0 0 C0 -29.06, 0 -58.13, 0 -80" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(603.6666685342789 293.166671872139) rotate(0 0 -40)"><path d="M10.26 -51.81 C7.34 -59.83, 4.42 -67.85, 0 -80 M10.26 -51.81 C6.53 -62.05, 2.81 -72.29, 0 -80" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(603.6666685342789 293.166671872139) rotate(0 0 -40)"><path d="M-10.26 -51.81 C-7.34 -59.83, -4.42 -67.85, 0 -80 M-10.26 -51.81 C-6.53 -62.05, -2.81 -72.29, 0 -80" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(713.6666685342789 293.166671872139) rotate(0 0 -40)"><path d="M0 0 C0 -23.7, 0 -47.4, 0 -80 M0 0 C0 -31.07, 0 -62.15, 0 -80" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(713.6666685342789 293.166671872139) rotate(0 0 -40)"><path d="M10.26 -51.81 C7.22 -60.16, 4.18 -68.51, 0 -80 M10.26 -51.81 C6.28 -62.76, 2.29 -73.71, 0 -80" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(713.6666685342789 293.166671872139) rotate(0 0 -40)"><path d="M-10.26 -51.81 C-7.22 -60.16, -4.18 -68.51, 0 -80 M-10.26 -51.81 C-6.28 -62.76, -2.29 -73.71, 0 -80" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(445.66666853427887 249.16667187213898) rotate(0 72.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Thread.sleep();</text></g><g transform="translate(719.6666752099991 249.16667187213898) rotate(0 69 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Thread.wait();</text></g><g stroke-linecap="round"><g transform="translate(294.16666400432587 311.83333575725555) rotate(0 134 0)"><path d="M0 0 C77.3 0, 154.61 0, 268 0 M0 0 C106.68 0, 213.36 0, 268 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(294.16666400432587 311.83333575725555) rotate(0 134 0)"><path d="M239.81 10.26 C247.94 7.3, 256.07 4.34, 268 0 M239.81 10.26 C251.03 6.18, 262.25 2.09, 268 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(294.16666400432587 311.83333575725555) rotate(0 134 0)"><path d="M239.81 -10.26 C247.94 -7.3, 256.07 -4.34, 268 0 M239.81 -10.26 C251.03 -6.18, 262.25 -2.09, 268 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(561.1666640043259 335.83333575725555) rotate(0 -133 0)"><path d="M0 0 C-53.79 0, -107.58 0, -266 0 M0 0 C-68.48 0, -136.95 0, -266 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(561.1666640043259 335.83333575725555) rotate(0 -133 0)"><path d="M-237.81 -10.26 C-243.51 -8.19, -249.21 -6.11, -266 0 M-237.81 -10.26 C-245.07 -7.62, -252.32 -4.98, -266 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(561.1666640043259 335.83333575725555) rotate(0 -133 0)"><path d="M-237.81 10.26 C-243.51 8.19, -249.21 6.11, -266 0 M-237.81 10.26 C-245.07 7.62, -252.32 4.98, -266 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(308.16666400432587 287.83333575725555) rotate(0 70.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">被调度程序选中</text></g><g transform="translate(440.16666400432587 339.83333575725555) rotate(0 60.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">调度程序交换</text></g><g stroke-linecap="round"><g transform="translate(757.0000084638596 336.83333575725555) rotate(0 111 0)"><path d="M0 0 C71.42 0, 142.84 0, 222 0 M0 0 C70.76 0, 141.51 0, 222 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(757.0000084638596 336.83333575725555) rotate(0 111 0)"><path d="M193.81 10.26 C202.88 6.96, 211.95 3.66, 222 0 M193.81 10.26 C202.79 6.99, 211.78 3.72, 222 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(757.0000084638596 336.83333575725555) rotate(0 111 0)"><path d="M193.81 -10.26 C202.88 -6.96, 211.95 -3.66, 222 0 M193.81 -10.26 C202.79 -6.99, 211.78 -3.72, 222 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(849.0000084638596 311.83333575725555) rotate(0 20.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">完毕</text></g><g stroke-linecap="round"><g transform="translate(633.0000003576279 372.1666716337204) rotate(0 0 52.5)"><path d="M0 0 C0 37.8, 0 75.61, 0 105 M0 0 C0 41.84, 0 83.67, 0 105" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(633.0000003576279 372.1666716337204) rotate(0 0 52.5)"><path d="M-10.26 76.81 C-6.57 86.96, -2.87 97.11, 0 105 M-10.26 76.81 C-6.17 88.04, -2.08 99.27, 0 105" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(633.0000003576279 372.1666716337204) rotate(0 0 52.5)"><path d="M10.26 76.81 C6.57 86.96, 2.87 97.11, 0 105 M10.26 76.81 C6.17 88.04, 2.08 99.27, 0 105" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(671.0000003576279 474.1666716337204) rotate(0 0 -50)"><path d="M0 0 C0 -30.53, 0 -61.06, 0 -100 M0 0 C0 -32.13, 0 -64.26, 0 -100" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(671.0000003576279 474.1666716337204) rotate(0 0 -50)"><path d="M10.26 -71.81 C7.13 -80.42, 4 -89.02, 0 -100 M10.26 -71.81 C6.96 -80.87, 3.67 -89.92, 0 -100" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(671.0000003576279 474.1666716337204) rotate(0 0 -50)"><path d="M-10.26 -71.81 C-7.13 -80.42, -4 -89.02, 0 -100 M-10.26 -71.81 C-6.96 -80.87, -3.67 -89.92, 0 -100" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(675.0000003576279 417.1666716337204) rotate(0 80.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">收到（同步）数据</text></g><g stroke-linecap="round"><g transform="translate(750.3333464860916 517.1666716337204) rotate(0 150.5 -71.99999999999997)"><path d="M0 0 C75.22 0.75, 150.44 1.5, 301 3 M0 0 C80.1 0.8, 160.2 1.6, 301 3 M301 3 C301 -39.56, 301 -82.13, 301 -147 M301 3 C301 -55.77, 301 -114.54, 301 -147" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(750.3333464860916 517.1666716337204) rotate(0 150.5 -71.99999999999997)"><path d="M311.26 -118.81 C308.7 -125.85, 306.13 -132.9, 301 -147 M311.26 -118.81 C308.53 -126.31, 305.8 -133.81, 301 -147" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(750.3333464860916 517.1666716337204) rotate(0 150.5 -71.99999999999997)"><path d="M290.74 -118.81 C293.3 -125.85, 295.87 -132.9, 301 -147 M290.74 -118.81 C293.47 -126.31, 296.2 -133.81, 301 -147" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(809.3333464860916 521.1666716337204) rotate(0 100.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">其他线程关闭了套接字</text></g></svg>

使用 `Thread.sleep()` 方法可以让线程休眠。这个方法有一个参数，指定线程休眠的时间，单位为毫秒，如下所示：

```java
try {
	Thread,sleep(2000);    //线程休眠2s
} catch(InterruptedException e) {
	e.printStackTrace();
}
```

tip：参数中指定的休眠时长是对操作系统的请求，而不是要求。例如，休眠的时间可能比请求的长。具体休眠多久，取决于负载和运行时环境相关的其他因素。

# 对象的可见性和可变性

在Java中，其实一个进程的每个Java应用线程都有自己的栈（和局部变量），不过这些线程共用一个堆，因此可以轻易在线程之间共享对象，毕竟需要做的只是把引用从一个线程传到另一个线程，如下图所示：

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 770.2083459496498 815.0834271599076" width="770.2083459496498" height="815.0834271599076">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://www.iodraw.com/whiteboard/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://www.iodraw.com/whiteboard/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="770.2083459496498" height="815.0834271599076" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(10.625006556510925 47.9583158493042) rotate(0 68.75 145.625)"><path d="M0 0 C41.23 0, 82.46 0, 137.5 0 M0 0 C39.48 0, 78.96 0, 137.5 0 M137.5 0 C137.5 107.81, 137.5 215.62, 137.5 291.25 M137.5 0 C137.5 113.31, 137.5 226.62, 137.5 291.25 M137.5 291.25 C105.07 291.25, 72.65 291.25, 0 291.25 M137.5 291.25 C85 291.25, 32.49 291.25, 0 291.25 M0 291.25 C0 206.16, 0 121.08, 0 0 M0 291.25 C0 216.2, 0 141.16, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(259.3750065565109 51.7083158493042) rotate(0 83.125 53.125)"><path d="M0 0 C48.57 0, 97.14 0, 166.25 0 M0 0 C42.84 0, 85.67 0, 166.25 0 M166.25 0 C166.25 33.97, 166.25 67.94, 166.25 106.25 M166.25 0 C166.25 41.5, 166.25 82.99, 166.25 106.25 M166.25 106.25 C103.91 106.25, 41.56 106.25, 0 106.25 M166.25 106.25 C100.43 106.25, 34.61 106.25, 0 106.25 M0 106.25 C0 65.77, 0 25.29, 0 0 M0 106.25 C0 75.47, 0 44.68, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(263.1250065565109 227.9583158493042) rotate(0 79.375 58.125)"><path d="M0 0 C62.85 0, 125.7 0, 158.75 0 M0 0 C60.48 0, 120.96 0, 158.75 0 M158.75 0 C158.75 33.68, 158.75 67.36, 158.75 116.25 M158.75 0 C158.75 25.31, 158.75 50.61, 158.75 116.25 M158.75 116.25 C103.48 116.25, 48.22 116.25, 0 116.25 M158.75 116.25 C109.05 116.25, 59.36 116.25, 0 116.25 M0 116.25 C0 85.25, 0 54.24, 0 0 M0 116.25 C0 77.51, 0 38.77, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(494.3750065565109 44.2083158493042) rotate(0 131.25 150)"><path d="M0 0 C83.4 0, 166.81 0, 262.5 0 M0 0 C102.36 0, 204.71 0, 262.5 0 M262.5 0 C262.5 67, 262.5 133.99, 262.5 300 M262.5 0 C262.5 70.58, 262.5 141.15, 262.5 300 M262.5 300 C190.61 300, 118.73 300, 0 300 M262.5 300 C181.31 300, 100.11 300, 0 300 M0 300 C0 233.23, 0 166.46, 0 0 M0 300 C0 205.23, 0 110.46, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(176.87500655651093 464.41665852069855) rotate(0 34.375 147.5)"><path d="M0 0 C19.52 0, 39.04 0, 68.75 0 M0 0 C17.76 0, 35.52 0, 68.75 0 M68.75 0 C68.75 60.54, 68.75 121.07, 68.75 295 M68.75 0 C68.75 102.4, 68.75 204.79, 68.75 295 M68.75 295 C46.06 295, 23.37 295, 0 295 M68.75 295 C54.84 295, 40.92 295, 0 295 M0 295 C0 218.89, 0 142.79, 0 0 M0 295 C0 201.12, 0 107.24, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(11.25 95.04166269302368) rotate(0 67.5 0)"><path d="M0 0 C42.38 0, 84.76 0, 135 0 M0 0 C33.83 0, 67.66 0, 135 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(10 148.79166269302368) rotate(0 68.75 0)"><path d="M0 0 C46.55 0, 93.11 0, 137.5 0 M0 0 C48.01 0, 96.03 0, 137.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(10 198.79166269302368) rotate(0 68.125 0)"><path d="M0 0 C42.95 0, 85.9 0, 136.25 0 M0 0 C37.57 0, 75.14 0, 136.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(10 248.79166269302368) rotate(0 68.75 0)"><path d="M0 0 C48.79 0, 97.59 0, 137.5 0 M0 0 C38.23 0, 76.47 0, 137.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(11.25 297.5416626930237) rotate(0 68.125 0)"><path d="M0 0 C29.15 0, 58.31 0, 136.25 0 M0 0 C51.22 0, 102.43 0, 136.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(50 47.54166269302368) rotate(0 0 146.875)"><path d="M0 0 C0 77.18, 0 154.36, 0 293.75 M0 0 C0 113.45, 0 226.89, 0 293.75" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(100 48.79166269302368) rotate(0 0 146.25)"><path d="M0 0 C0 101.61, 0 203.21, 0 292.5 M0 0 C0 90.46, 0 180.93, 0 292.5" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(261.25 93.79166269302368) rotate(0 81.875 0)"><path d="M0 0 C47 0, 94 0, 163.75 0 M0 0 C53.21 0, 106.41 0, 163.75 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(260 128.79166269302368) rotate(0 81.875 0)"><path d="M0 0 C55.62 0, 111.24 0, 163.75 0 M0 0 C52.84 0, 105.68 0, 163.75 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(298.75 52.54166269302368) rotate(0 0 54.375)"><path d="M0 0 C0 40.97, 0 81.94, 0 108.75 M0 0 C0 27.45, 0 54.9, 0 108.75" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(338.75 52.54166269302368) rotate(0 0 54.375)"><path d="M0 0 C0 30.27, 0 60.53, 0 108.75 M0 0 C0 43.01, 0 86.03, 0 108.75" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(377.5 48.79166269302368) rotate(0 0 55.625)"><path d="M0 0 C0 34.11, 0 68.23, 0 111.25 M0 0 C0 44.17, 0 88.33, 0 111.25" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(265 272.5416626930237) rotate(0 78.125 0)"><path d="M0 0 C31.8 0, 63.61 0, 156.25 0 M0 0 C33.15 0, 66.31 0, 156.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(260 308.7916626930237) rotate(0 80.625 0)"><path d="M0 0 C35.12 0, 70.25 0, 161.25 0 M0 0 C44.88 0, 89.76 0, 161.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(312.5 226.29166269302368) rotate(0 0 60.625)"><path d="M0 0 C0 43.97, 0 87.93, 0 121.25 M0 0 C0 31.54, 0 63.08, 0 121.25" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(366.25 228.79166269302368) rotate(0 0 59.375)"><path d="M0 0 C0 31.18, 0 62.36, 0 118.75 M0 0 C0 33.94, 0 67.89, 0 118.75" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(495.2083459496498 88.79166269302368) rotate(0 131.875 0)"><path d="M0 0 C102.33 0, 204.67 0, 263.75 0 M0 0 C80.48 0, 160.95 0, 263.75 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(493.9583459496498 133.79166269302368) rotate(0 132.5 0)"><path d="M0 0 C99.94 0, 199.88 0, 265 0 M0 0 C67.28 0, 134.55 0, 265 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(490.2083459496498 180.04166269302368) rotate(0 135 0)"><path d="M0 0 C72.61 0, 145.21 0, 270 0 M0 0 C95.34 0, 190.67 0, 270 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(496.4583459496498 222.54166269302368) rotate(0 128.75 0)"><path d="M0 0 C91.08 0, 182.16 0, 257.5 0 M0 0 C69.86 0, 139.71 0, 257.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(496.4583459496498 265.0416626930237) rotate(0 129.375 0)"><path d="M0 0 C88.64 0, 177.29 0, 258.75 0 M0 0 C84.86 0, 169.71 0, 258.75 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(493.9583459496498 307.5416626930237) rotate(0 131.875 0)"><path d="M0 0 C68.72 0, 137.45 0, 263.75 0 M0 0 C71.31 0, 142.63 0, 263.75 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(545.2083459496498 45.04166269302368) rotate(0 0 148.125)"><path d="M0 0 C0 69.57, 0 139.15, 0 296.25 M0 0 C0 94.01, 0 188.02, 0 296.25" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(597.7083459496498 42.54166269302368) rotate(0 0 149.375)"><path d="M0 0 C0 85.39, 0 170.78, 0 298.75 M0 0 C0 70.13, 0 140.26, 0 298.75" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(651.4583459496498 41.29166269302368) rotate(0 0 153.125)"><path d="M0 0 C0 61.27, 0 122.54, 0 306.25 M0 0 C0 61.79, 0 123.57, 0 306.25" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(706.4583459496498 47.54166269302368) rotate(0 0 149.375)"><path d="M0 0 C0 106.58, 0 213.17, 0 298.75 M0 0 C0 80.36, 0 160.72, 0 298.75" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(177.91668683290482 508.1666826605797) rotate(0 33.125 0)"><path d="M0 0 C25.75 0, 51.5 0, 66.25 0 M0 0 C14.52 0, 29.04 0, 66.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(176.66668683290482 549.4166826605797) rotate(0 33.75 0)"><path d="M0 0 C14.92 0, 29.83 0, 67.5 0 M0 0 C26.58 0, 53.17 0, 67.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(176.66668683290482 590.6666826605797) rotate(0 34.375 0)"><path d="M0 0 C21.73 0, 43.46 0, 68.75 0 M0 0 C16.28 0, 32.56 0, 68.75 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(176.66668683290482 630.6666826605797) rotate(0 33.125 0)"><path d="M0 0 C23.16 0, 46.32 0, 66.25 0 M0 0 C21.41 0, 42.81 0, 66.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(176.66668683290482 673.1666826605797) rotate(0 33.75 0)"><path d="M0 0 C25.22 0, 50.45 0, 67.5 0 M0 0 C24.54 0, 49.08 0, 67.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(179.16668683290482 718.1666826605797) rotate(0 33.75 0)"><path d="M0 0 C25.58 0, 51.16 0, 67.5 0 M0 0 C19.64 0, 39.29 0, 67.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round" transform="translate(321.8750065565109 463.1666826605797) rotate(0 34.375 147.5)"><path d="M0 0 C22.36 0, 44.73 0, 68.75 0 M0 0 C19.52 0, 39.03 0, 68.75 0 M68.75 0 C68.75 72.74, 68.75 145.48, 68.75 295 M68.75 0 C68.75 69.89, 68.75 139.77, 68.75 295 M68.75 295 C45.38 295, 22 295, 0 295 M68.75 295 C42.15 295, 15.55 295, 0 295 M0 295 C0 217.6, 0 140.21, 0 0 M0 295 C0 211.64, 0 128.29, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(322.9166868329048 506.9167068004608) rotate(0 33.125 0)"><path d="M0 0 C22.24 0, 44.49 0, 66.25 0 M0 0 C19.72 0, 39.44 0, 66.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(321.6666868329048 548.1667068004608) rotate(0 33.75 0)"><path d="M0 0 C21.6 0, 43.19 0, 67.5 0 M0 0 C14.6 0, 29.2 0, 67.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(321.6666868329048 589.4167068004608) rotate(0 34.375 0)"><path d="M0 0 C23.06 0, 46.13 0, 68.75 0 M0 0 C21.11 0, 42.22 0, 68.75 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(321.6666868329048 629.4167068004608) rotate(0 33.125 0)"><path d="M0 0 C23.82 0, 47.64 0, 66.25 0 M0 0 C17.15 0, 34.31 0, 66.25 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(321.6666868329048 671.9167068004608) rotate(0 33.75 0)"><path d="M0 0 C18.46 0, 36.92 0, 67.5 0 M0 0 C14.52 0, 29.04 0, 67.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(324.1666868329048 716.9167068004608) rotate(0 33.75 0)"><path d="M0 0 C18.75 0, 37.5 0, 67.5 0 M0 0 C22.51 0, 45.01 0, 67.5 0" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g transform="translate(54.166686832904816 11.25) rotate(0 33 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Eden区</text></g><g transform="translate(300.4166868329048 18.75) rotate(0 49 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Survivor区</text></g><g transform="translate(583.3333671092987 10) rotate(0 50 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">Tenured区</text></g><g transform="translate(52.73635424212125 97.83893687930822) rotate(0 21.521739130434753 23.478260869565247)" stroke="none"><path fill="#000000" d="M 2.50,0 Q 2.50,0 2.55,0.81 2.60,1.62 2.71,2.83 2.81,4.03 2.92,5.24 3.02,6.45 3.09,7.53 3.16,8.60 3.23,9.89 3.29,11.18 3.45,12.34 3.60,13.51 3.65,14.70 3.69,15.89 3.73,17.11 3.76,18.32 3.79,19.46 3.82,20.59 3.92,21.75 4.02,22.91 4.07,24.00 4.12,25.09 4.13,26.19 4.15,27.29 4.26,28.46 4.38,29.63 4.40,30.70 4.42,31.77 4.42,32.91 4.43,34.05 4.52,35.22 4.60,36.40 4.63,37.50 4.67,38.59 4.68,39.81 4.69,41.02 4.70,42.17 4.71,43.31 4.72,44.40 4.73,45.49 3.95,44.60 3.16,43.71 4.22,43.38 5.27,43.06 6.33,43.05 7.40,43.05 8.66,42.88 9.91,42.71 11.15,42.49 12.38,42.27 13.55,42.22 14.72,42.18 15.86,42.09 17.01,42.01 18.23,42.00 19.45,41.98 20.58,41.98 21.70,41.97 22.91,41.97 24.11,41.97 25.36,41.97 26.61,41.96 27.71,41.96 28.82,41.96 29.90,41.96 30.99,41.96 32.08,41.96 33.16,41.96 34.30,41.96 35.44,41.96 36.56,41.96 37.68,41.96 38.75,41.95 39.82,41.95 40.91,41.95 42.00,41.95 40.56,42.73 39.12,43.51 38.80,42.49 38.47,41.46 38.48,40.16 38.49,38.85 38.49,37.60 38.49,36.35 38.50,35.23 38.50,34.12 38.70,33.03 38.91,31.93 39.04,30.74 39.17,29.56 39.17,28.30 39.17,27.04 39.17,25.95 39.16,24.87 39.16,23.78 39.17,22.68 39.07,21.21 38.98,19.74 38.79,18.35 38.60,16.97 38.37,15.86 38.13,14.76 38.00,13.52 37.86,12.28 37.85,11.14 37.85,9.99 37.85,8.73 37.85,7.47 37.95,5.97 38.05,4.46 38.37,2.87 38.69,1.28 39.51,3.13 40.34,4.99 39.26,5.31 38.19,5.62 37.04,5.62 35.89,5.62 34.65,5.61 33.40,5.61 32.27,5.61 31.14,5.61 30.07,5.62 29.00,5.62 27.78,5.62 26.56,5.62 25.43,5.63 24.31,5.63 23.22,5.63 22.12,5.63 20.88,5.64 19.64,5.64 18.50,5.64 17.36,5.64 16.29,5.64 15.22,5.65 13.88,5.72 12.54,5.80 11.31,5.83 10.08,5.85 8.92,5.86 7.76,5.86 5.84,5.87 3.91,5.87 3.28,5.77 2.66,5.66 2.10,5.37 1.54,5.07 1.10,4.61 0.67,4.15 0.40,3.57 0.13,3.00 0.07,2.37 0.00,1.74 0.13,1.12 0.27,0.50 0.60,-0.03 0.92,-0.57 1.41,-0.98 1.89,-1.39 2.48,-1.63 3.07,-1.86 3.70,-1.90 4.33,-1.93 4.94,-1.76 5.55,-1.59 6.08,-1.24 6.60,-0.88 6.98,-0.38 7.37,0.12 7.57,0.72 7.77,1.32 7.77,1.95 7.77,2.59 7.57,3.19 7.37,3.79 6.98,4.29 6.60,4.80 6.08,5.15 5.55,5.51 4.94,5.68 4.33,5.84 3.70,5.81 3.07,5.78 2.48,5.54 1.89,5.31 1.41,4.90 0.92,4.49 0.60,3.94 0.27,3.40 0.13,2.78 0.00,2.16 0.07,1.53 0.13,0.90 0.40,0.33 0.67,-0.24 1.10,-0.70 1.54,-1.16 2.10,-1.45 2.66,-1.75 3.28,-1.85 3.91,-1.95 3.91,-1.95 3.91,-1.95 6.49,-1.95 9.07,-1.95 10.15,-1.95 11.24,-1.95 12.41,-2.06 13.59,-2.17 14.77,-2.17 15.94,-2.17 17.13,-2.16 18.31,-2.16 19.51,-2.16 20.71,-2.16 21.82,-2.15 22.93,-2.15 24.07,-2.15 25.21,-2.15 26.32,-2.15 27.42,-2.14 28.62,-2.14 29.82,-2.14 31.00,-2.14 32.18,-2.13 33.33,-2.13 34.48,-2.13 35.79,-2.14 37.10,-2.14 38.20,-2.15 39.30,-2.15 40.55,-2.15 41.80,-2.14 43.21,-1.76 44.62,-1.37 45.24,-0.33 45.86,0.70 46.11,1.96 46.37,3.21 46.07,4.29 45.77,5.37 45.69,6.63 45.62,7.88 45.62,9.08 45.62,10.29 45.48,11.39 45.34,12.49 45.60,13.59 45.86,14.69 46.16,15.94 46.47,17.20 46.59,18.68 46.71,20.15 46.81,21.42 46.91,22.68 46.91,23.99 46.91,25.30 46.91,26.56 46.91,27.82 46.89,28.97 46.88,30.13 46.76,31.52 46.63,32.91 46.45,34.01 46.27,35.11 46.28,36.38 46.29,37.65 46.29,38.82 46.29,39.99 46.29,41.37 46.29,42.75 46.29,44.01 46.29,45.26 45.90,46.61 45.51,47.97 44.49,48.56 43.47,49.16 42.36,49.47 41.26,49.78 40.11,49.78 38.96,49.78 37.81,49.77 36.66,49.77 35.59,49.77 34.51,49.77 33.42,49.77 32.33,49.77 31.09,49.77 29.85,49.77 28.64,49.77 27.43,49.77 26.33,49.76 25.23,49.76 24.07,49.76 22.92,49.75 21.75,49.75 20.59,49.75 19.34,49.76 18.10,49.78 16.95,49.88 15.80,49.99 14.70,49.96 13.59,49.93 12.23,50.24 10.87,50.55 9.43,50.70 8.00,50.86 6.85,50.85 5.70,50.85 4.57,50.84 3.43,50.84 2.24,50.82 1.05,50.80 -0.06,50.43 -1.18,50.06 -1.77,49.05 -2.36,48.05 -2.68,46.99 -2.99,45.92 -2.98,44.83 -2.97,43.75 -2.96,42.65 -2.96,41.55 -2.95,40.42 -2.94,39.29 -2.93,38.18 -2.93,37.08 -3.03,35.56 -3.13,34.05 -3.12,32.91 -3.11,31.77 -3.06,30.62 -3.01,29.46 -3.14,28.38 -3.28,27.29 -3.27,26.21 -3.26,25.12 -3.34,23.93 -3.42,22.74 -3.40,21.67 -3.39,20.59 -3.36,19.46 -3.33,18.32 -3.29,17.11 -3.26,15.90 -3.21,14.61 -3.17,13.32 -3.23,12.25 -3.29,11.18 -3.23,9.89 -3.16,8.60 -3.09,7.53 -3.02,6.45 -2.92,5.24 -2.81,4.03 -2.71,2.83 -2.60,1.62 -2.55,0.81 -2.50,0 -2.47,-0.30 -2.43,-0.60 -2.32,-0.88 -2.22,-1.16 -2.04,-1.41 -1.87,-1.66 -1.65,-1.86 -1.42,-2.06 -1.15,-2.20 -0.88,-2.34 -0.59,-2.41 -0.30,-2.48 0.00,-2.48 0.30,-2.48 0.59,-2.41 0.88,-2.34 1.15,-2.20 1.42,-2.06 1.65,-1.86 1.87,-1.66 2.04,-1.41 2.22,-1.16 2.32,-0.88 2.43,-0.60 2.47,-0.29 2.50,0.00 2.50,0.00 L 2.50,0 Z"></path></g><g transform="translate(98.26775573812347 245.8461839990183) rotate(0 21.521739130434753 23.478260869565304)" stroke="none"><path fill="#000000" d="M 2.50,0 Q 2.50,0 2.55,0.81 2.60,1.62 2.71,2.83 2.81,4.03 2.92,5.24 3.02,6.45 3.09,7.53 3.16,8.60 3.23,9.89 3.29,11.18 3.45,12.34 3.60,13.51 3.65,14.70 3.69,15.89 3.73,17.11 3.76,18.32 3.79,19.46 3.82,20.59 3.92,21.75 4.02,22.91 4.07,24.00 4.12,25.09 4.13,26.19 4.15,27.29 4.26,28.46 4.38,29.63 4.40,30.70 4.42,31.77 4.42,32.91 4.43,34.05 4.52,35.22 4.60,36.40 4.63,37.50 4.67,38.59 4.68,39.81 4.69,41.02 4.70,42.17 4.71,43.31 4.72,44.40 4.73,45.49 3.95,44.60 3.16,43.71 4.22,43.38 5.27,43.06 6.33,43.05 7.40,43.05 8.66,42.88 9.91,42.71 11.15,42.49 12.38,42.27 13.55,42.22 14.72,42.18 15.86,42.09 17.01,42.01 18.23,42.00 19.45,41.98 20.58,41.98 21.70,41.97 22.91,41.97 24.11,41.97 25.36,41.97 26.61,41.96 27.71,41.96 28.82,41.96 29.90,41.96 30.99,41.96 32.08,41.96 33.16,41.96 34.30,41.96 35.44,41.96 36.56,41.96 37.68,41.96 38.75,41.95 39.82,41.95 40.91,41.95 42.00,41.95 40.56,42.73 39.12,43.51 38.80,42.49 38.47,41.46 38.48,40.16 38.49,38.85 38.49,37.60 38.49,36.35 38.50,35.23 38.50,34.12 38.70,33.03 38.91,31.93 39.04,30.74 39.17,29.56 39.17,28.30 39.17,27.04 39.17,25.95 39.16,24.87 39.16,23.78 39.17,22.68 39.07,21.21 38.98,19.74 38.79,18.35 38.60,16.97 38.37,15.86 38.13,14.76 38.00,13.52 37.86,12.28 37.85,11.14 37.85,9.99 37.85,8.73 37.85,7.47 37.95,5.97 38.05,4.46 38.37,2.87 38.69,1.28 39.51,3.13 40.34,4.99 39.26,5.31 38.19,5.62 37.04,5.62 35.89,5.62 34.65,5.61 33.40,5.61 32.27,5.61 31.14,5.61 30.07,5.62 29.00,5.62 27.78,5.62 26.56,5.62 25.43,5.63 24.31,5.63 23.22,5.63 22.12,5.63 20.88,5.64 19.64,5.64 18.50,5.64 17.36,5.64 16.29,5.64 15.22,5.65 13.88,5.72 12.54,5.80 11.31,5.83 10.08,5.85 8.92,5.86 7.76,5.86 5.88,5.87 3.99,5.87 3.37,5.77 2.74,5.66 2.18,5.37 1.62,5.07 1.19,4.61 0.75,4.15 0.49,3.57 0.22,3.00 0.15,2.37 0.08,1.74 0.22,1.12 0.36,0.50 0.68,-0.03 1.01,-0.57 1.49,-0.98 1.98,-1.39 2.56,-1.63 3.15,-1.86 3.79,-1.90 4.42,-1.93 5.03,-1.76 5.64,-1.59 6.16,-1.24 6.69,-0.88 7.07,-0.38 7.45,0.12 7.66,0.72 7.86,1.32 7.86,1.95 7.86,2.59 7.66,3.19 7.45,3.79 7.07,4.29 6.69,4.80 6.16,5.15 5.64,5.51 5.03,5.68 4.42,5.84 3.78,5.81 3.15,5.78 2.56,5.54 1.97,5.31 1.49,4.90 1.01,4.49 0.68,3.94 0.36,3.40 0.22,2.78 0.08,2.16 0.15,1.53 0.22,0.90 0.49,0.33 0.75,-0.24 1.19,-0.70 1.63,-1.16 2.19,-1.45 2.75,-1.75 3.37,-1.85 4.00,-1.95 4.00,-1.95 3.99,-1.95 6.53,-1.95 9.07,-1.95 10.15,-1.95 11.24,-1.95 12.41,-2.06 13.59,-2.17 14.77,-2.17 15.94,-2.17 17.13,-2.16 18.31,-2.16 19.51,-2.16 20.71,-2.16 21.82,-2.15 22.93,-2.15 24.07,-2.15 25.21,-2.15 26.32,-2.15 27.42,-2.14 28.62,-2.14 29.82,-2.14 31.00,-2.14 32.18,-2.13 33.33,-2.13 34.48,-2.13 35.79,-2.14 37.10,-2.14 38.20,-2.15 39.30,-2.15 40.55,-2.15 41.80,-2.14 43.21,-1.76 44.62,-1.37 45.24,-0.33 45.86,0.70 46.11,1.96 46.37,3.21 46.07,4.29 45.77,5.37 45.69,6.63 45.62,7.88 45.62,9.08 45.62,10.29 45.48,11.39 45.34,12.49 45.60,13.59 45.86,14.69 46.16,15.94 46.47,17.20 46.59,18.68 46.71,20.15 46.81,21.42 46.91,22.68 46.91,23.99 46.91,25.30 46.91,26.56 46.91,27.82 46.89,28.97 46.88,30.13 46.76,31.52 46.63,32.91 46.45,34.01 46.27,35.11 46.28,36.38 46.29,37.65 46.29,38.82 46.29,39.99 46.29,41.37 46.29,42.75 46.29,44.01 46.29,45.26 45.90,46.61 45.51,47.97 44.49,48.56 43.47,49.16 42.36,49.47 41.26,49.78 40.11,49.78 38.96,49.78 37.81,49.77 36.66,49.77 35.59,49.77 34.51,49.77 33.42,49.77 32.33,49.77 31.09,49.77 29.85,49.77 28.64,49.77 27.43,49.77 26.33,49.76 25.23,49.76 24.07,49.76 22.92,49.75 21.75,49.75 20.59,49.75 19.34,49.76 18.10,49.78 16.95,49.88 15.80,49.99 14.70,49.96 13.59,49.93 12.23,50.24 10.87,50.55 9.43,50.70 8.00,50.86 6.85,50.85 5.70,50.85 4.57,50.84 3.43,50.84 2.24,50.82 1.05,50.80 -0.06,50.43 -1.18,50.06 -1.77,49.05 -2.36,48.05 -2.68,46.99 -2.99,45.92 -2.98,44.83 -2.97,43.75 -2.96,42.65 -2.96,41.55 -2.95,40.42 -2.94,39.29 -2.93,38.18 -2.93,37.08 -3.03,35.56 -3.13,34.05 -3.12,32.91 -3.11,31.77 -3.06,30.62 -3.01,29.46 -3.14,28.38 -3.28,27.29 -3.27,26.21 -3.26,25.12 -3.34,23.93 -3.42,22.74 -3.40,21.67 -3.39,20.59 -3.36,19.46 -3.33,18.32 -3.29,17.11 -3.26,15.90 -3.21,14.61 -3.17,13.32 -3.23,12.25 -3.29,11.18 -3.23,9.89 -3.16,8.60 -3.09,7.53 -3.02,6.45 -2.92,5.24 -2.81,4.03 -2.71,2.83 -2.60,1.62 -2.55,0.81 -2.50,0 -2.47,-0.30 -2.43,-0.60 -2.32,-0.88 -2.22,-1.16 -2.04,-1.41 -1.87,-1.66 -1.65,-1.86 -1.42,-2.06 -1.15,-2.20 -0.88,-2.34 -0.59,-2.41 -0.30,-2.48 0.00,-2.48 0.30,-2.48 0.59,-2.41 0.88,-2.34 1.15,-2.20 1.42,-2.06 1.65,-1.86 1.87,-1.66 2.04,-1.41 2.22,-1.16 2.32,-0.88 2.43,-0.60 2.47,-0.29 2.50,0.00 2.50,0.00 L 2.50,0 Z"></path></g><g transform="translate(601.6010890714579 130.84618399901808) rotate(0 21.521739130434753 23.478260869565247)" stroke="none"><path fill="#000000" d="M 2.50,0 Q 2.50,0 2.55,0.81 2.60,1.62 2.71,2.83 2.81,4.03 2.92,5.24 3.02,6.45 3.09,7.53 3.16,8.60 3.23,9.89 3.29,11.18 3.45,12.34 3.60,13.51 3.65,14.70 3.69,15.89 3.73,17.11 3.76,18.32 3.79,19.46 3.82,20.59 3.92,21.75 4.02,22.91 4.07,24.00 4.12,25.09 4.13,26.19 4.15,27.29 4.26,28.46 4.38,29.63 4.40,30.70 4.42,31.77 4.42,32.91 4.43,34.05 4.52,35.22 4.60,36.40 4.63,37.50 4.67,38.59 4.68,39.81 4.69,41.02 4.70,42.17 4.71,43.31 4.72,44.40 4.73,45.49 3.95,44.60 3.16,43.71 4.22,43.38 5.27,43.06 6.33,43.05 7.40,43.05 8.66,42.88 9.91,42.71 11.15,42.49 12.38,42.27 13.55,42.22 14.72,42.18 15.86,42.09 17.01,42.01 18.23,42.00 19.45,41.98 20.58,41.98 21.70,41.97 22.91,41.97 24.11,41.97 25.36,41.97 26.61,41.96 27.71,41.96 28.82,41.96 29.90,41.96 30.99,41.96 32.08,41.96 33.16,41.96 34.30,41.96 35.44,41.96 36.56,41.96 37.68,41.96 38.75,41.95 39.82,41.95 40.91,41.95 42.00,41.95 40.56,42.73 39.12,43.51 38.80,42.49 38.47,41.46 38.48,40.16 38.49,38.85 38.49,37.60 38.49,36.35 38.50,35.23 38.50,34.12 38.70,33.03 38.91,31.93 39.04,30.74 39.17,29.56 39.17,28.30 39.17,27.04 39.17,25.95 39.16,24.87 39.16,23.78 39.17,22.68 39.07,21.21 38.98,19.74 38.79,18.35 38.60,16.97 38.37,15.86 38.13,14.76 38.00,13.52 37.86,12.28 37.85,11.14 37.85,9.99 37.85,8.73 37.85,7.47 37.95,5.97 38.05,4.46 38.37,2.87 38.69,1.28 39.51,3.13 40.34,4.99 39.26,5.31 38.19,5.62 37.04,5.62 35.89,5.62 34.65,5.61 33.40,5.61 32.27,5.61 31.14,5.61 30.07,5.62 29.00,5.62 27.78,5.62 26.56,5.62 25.43,5.63 24.31,5.63 23.22,5.63 22.12,5.63 20.88,5.64 19.64,5.64 18.50,5.64 17.36,5.64 16.29,5.64 15.22,5.65 13.88,5.72 12.54,5.80 11.31,5.83 10.08,5.85 8.92,5.86 7.76,5.86 5.88,5.87 3.99,5.87 3.37,5.77 2.74,5.66 2.18,5.37 1.62,5.07 1.19,4.61 0.75,4.15 0.49,3.57 0.22,3.00 0.15,2.37 0.08,1.74 0.22,1.12 0.36,0.50 0.68,-0.03 1.01,-0.57 1.49,-0.98 1.98,-1.39 2.56,-1.63 3.15,-1.86 3.79,-1.90 4.42,-1.93 5.03,-1.76 5.64,-1.59 6.16,-1.24 6.69,-0.88 7.07,-0.38 7.45,0.12 7.66,0.72 7.86,1.32 7.86,1.95 7.86,2.59 7.66,3.19 7.45,3.79 7.07,4.29 6.69,4.80 6.16,5.15 5.64,5.51 5.03,5.68 4.42,5.84 3.78,5.81 3.15,5.78 2.56,5.54 1.97,5.31 1.49,4.90 1.01,4.49 0.68,3.94 0.36,3.40 0.22,2.78 0.08,2.16 0.15,1.53 0.22,0.90 0.49,0.33 0.75,-0.24 1.19,-0.70 1.63,-1.16 2.19,-1.45 2.75,-1.75 3.37,-1.85 4.00,-1.95 4.00,-1.95 3.99,-1.95 6.53,-1.95 9.07,-1.95 10.15,-1.95 11.24,-1.95 12.41,-2.06 13.59,-2.17 14.77,-2.17 15.94,-2.17 17.13,-2.16 18.31,-2.16 19.51,-2.16 20.71,-2.16 21.82,-2.15 22.93,-2.15 24.07,-2.15 25.21,-2.15 26.32,-2.15 27.42,-2.14 28.62,-2.14 29.82,-2.14 31.00,-2.14 32.18,-2.13 33.33,-2.13 34.48,-2.13 35.79,-2.14 37.10,-2.14 38.20,-2.15 39.30,-2.15 40.55,-2.15 41.80,-2.14 43.21,-1.76 44.62,-1.37 45.24,-0.33 45.86,0.70 46.11,1.96 46.37,3.21 46.07,4.29 45.77,5.37 45.69,6.63 45.62,7.88 45.62,9.08 45.62,10.29 45.48,11.39 45.34,12.49 45.60,13.59 45.86,14.69 46.16,15.94 46.47,17.20 46.59,18.68 46.71,20.15 46.81,21.42 46.91,22.68 46.91,23.99 46.91,25.30 46.91,26.56 46.91,27.82 46.89,28.97 46.88,30.13 46.76,31.52 46.63,32.91 46.45,34.01 46.27,35.11 46.28,36.38 46.29,37.65 46.29,38.82 46.29,39.99 46.29,41.37 46.29,42.75 46.29,44.01 46.29,45.26 45.90,46.61 45.51,47.97 44.49,48.56 43.47,49.16 42.36,49.47 41.26,49.78 40.11,49.78 38.96,49.78 37.81,49.77 36.66,49.77 35.59,49.77 34.51,49.77 33.42,49.77 32.33,49.77 31.09,49.77 29.85,49.77 28.64,49.77 27.43,49.77 26.33,49.76 25.23,49.76 24.07,49.76 22.92,49.75 21.75,49.75 20.59,49.75 19.34,49.76 18.10,49.78 16.95,49.88 15.80,49.99 14.70,49.96 13.59,49.93 12.23,50.24 10.87,50.55 9.43,50.70 8.00,50.86 6.85,50.85 5.70,50.85 4.57,50.84 3.43,50.84 2.24,50.82 1.05,50.80 -0.06,50.43 -1.18,50.06 -1.77,49.05 -2.36,48.05 -2.68,46.99 -2.99,45.92 -2.98,44.83 -2.97,43.75 -2.96,42.65 -2.96,41.55 -2.95,40.42 -2.94,39.29 -2.93,38.18 -2.93,37.08 -3.03,35.56 -3.13,34.05 -3.12,32.91 -3.11,31.77 -3.06,30.62 -3.01,29.46 -3.14,28.38 -3.28,27.29 -3.27,26.21 -3.26,25.12 -3.34,23.93 -3.42,22.74 -3.40,21.67 -3.39,20.59 -3.36,19.46 -3.33,18.32 -3.29,17.11 -3.26,15.90 -3.21,14.61 -3.17,13.32 -3.23,12.25 -3.29,11.18 -3.23,9.89 -3.16,8.60 -3.09,7.53 -3.02,6.45 -2.92,5.24 -2.81,4.03 -2.71,2.83 -2.60,1.62 -2.55,0.81 -2.50,0 -2.47,-0.30 -2.43,-0.60 -2.32,-0.88 -2.22,-1.16 -2.04,-1.41 -1.87,-1.66 -1.65,-1.86 -1.42,-2.06 -1.15,-2.20 -0.88,-2.34 -0.59,-2.41 -0.30,-2.48 0.00,-2.48 0.30,-2.48 0.59,-2.41 0.88,-2.34 1.15,-2.20 1.42,-2.06 1.65,-1.86 1.87,-1.66 2.04,-1.41 2.22,-1.16 2.32,-0.88 2.43,-0.60 2.47,-0.29 2.50,0.00 2.50,0.00 L 2.50,0 Z"></path></g><g transform="translate(341.8351018437429 95.9408037639206) rotate(0 15.704225352112644 14.929577464788736)" stroke="none"><path fill="#000000" d="M 2.58,0 Q 2.58,0 2.61,1.05 2.65,2.10 2.72,3.23 2.80,4.36 2.87,5.44 2.95,6.52 3.04,7.89 3.13,9.27 3.19,10.73 3.26,12.18 3.30,13.51 3.34,14.83 3.38,15.92 3.42,17.01 3.46,18.23 3.50,19.44 3.58,20.75 3.67,22.06 3.71,23.13 3.75,24.20 3.77,25.36 3.80,26.51 3.83,27.61 3.85,28.70 3.39,27.71 2.94,26.71 4.13,26.38 5.32,26.05 6.50,26.04 7.68,26.03 8.99,26.02 10.31,26.01 11.56,25.94 12.82,25.87 13.90,25.86 14.97,25.85 16.17,25.85 17.38,25.84 18.57,25.84 19.77,25.83 20.88,25.76 21.98,25.68 23.23,25.68 24.48,25.68 25.68,25.68 26.89,25.68 28.02,25.67 29.16,25.67 28.33,27.23 27.50,28.78 27.49,27.56 27.49,26.34 27.48,25.25 27.48,24.17 27.48,23.05 27.48,21.93 27.42,20.81 27.35,19.69 27.09,18.43 26.82,17.18 26.68,15.96 26.54,14.75 26.52,13.60 26.51,12.46 26.51,11.23 26.51,10.00 26.50,8.85 26.50,7.69 26.50,6.47 26.50,5.25 26.50,4.10 26.49,2.95 27.36,4.10 28.23,5.26 27.08,5.44 25.94,5.62 24.77,5.62 23.61,5.62 22.50,5.62 21.38,5.62 20.17,5.62 18.96,5.62 17.72,5.61 16.48,5.61 15.37,5.61 14.26,5.61 13.17,5.54 12.08,5.46 11.00,5.46 9.92,5.46 8.79,5.34 7.65,5.22 4.29,4.72 0.93,4.21 0.52,3.72 0.12,3.23 -0.09,2.64 -0.32,2.05 -0.35,1.41 -0.37,0.78 -0.19,0.17 -0.01,-0.43 0.34,-0.95 0.71,-1.47 1.22,-1.85 1.73,-2.22 2.34,-2.42 2.94,-2.61 3.58,-2.60 4.21,-2.59 4.81,-2.38 5.41,-2.17 5.91,-1.77 6.41,-1.38 6.76,-0.85 7.10,-0.32 7.26,0.29 7.43,0.90 7.38,1.53 7.34,2.17 7.09,2.75 6.85,3.34 6.43,3.82 6.01,4.29 5.46,4.61 4.91,4.93 4.29,5.06 3.67,5.19 3.04,5.11 2.41,5.03 1.83,4.75 1.26,4.48 0.81,4.03 0.35,3.59 0.07,3.02 -0.21,2.46 -0.31,1.83 -0.40,1.20 -0.29,0.58 -0.17,-0.04 0.12,-0.60 0.43,-1.15 0.90,-1.58 1.36,-2.01 1.95,-2.27 2.53,-2.53 3.16,-2.58 3.79,-2.64 4.41,-2.50 5.03,-2.35 5.57,-2.01 6.10,-1.68 6.10,-1.68 6.10,-1.68 6.59,-2.10 7.07,-2.51 8.18,-2.44 9.29,-2.37 10.44,-2.36 11.59,-2.36 12.67,-2.29 13.75,-2.22 14.91,-2.23 16.07,-2.23 17.33,-2.23 18.58,-2.23 19.79,-2.23 20.99,-2.24 22.11,-2.24 23.23,-2.23 24.37,-2.24 25.52,-2.24 26.78,-2.24 28.05,-2.24 29.16,-2.08 30.28,-1.93 31.36,-1.58 32.44,-1.23 33.07,-0.21 33.70,0.79 34.02,2.53 34.34,4.26 34.34,5.39 34.33,6.53 34.33,7.59 34.33,8.65 34.33,9.79 34.33,10.93 34.33,12.14 34.33,13.35 34.40,14.46 34.47,15.58 34.63,16.67 34.80,17.76 34.99,18.84 35.18,19.92 35.25,21.09 35.33,22.25 35.32,23.37 35.32,24.48 35.32,25.70 35.32,26.92 35.31,28.16 35.30,29.39 34.94,30.50 34.58,31.61 33.56,32.24 32.54,32.87 30.97,33.17 29.40,33.48 28.31,33.47 27.22,33.47 26.06,33.47 24.90,33.46 23.83,33.46 22.76,33.46 21.48,33.52 20.21,33.58 19.04,33.59 17.87,33.59 16.77,33.58 15.67,33.58 14.51,33.57 13.34,33.57 12.23,33.63 11.11,33.70 9.95,33.69 8.80,33.69 7.68,33.68 6.56,33.67 5.46,33.66 4.37,33.65 3.28,33.63 2.19,33.61 1.13,33.46 0.08,33.31 -1.09,32.64 -2.26,31.97 -2.83,30.80 -3.40,29.63 -3.46,28.33 -3.53,27.02 -3.50,25.88 -3.48,24.73 -3.45,23.54 -3.43,22.34 -3.46,20.89 -3.50,19.44 -3.46,18.23 -3.42,17.01 -3.38,15.92 -3.34,14.83 -3.30,13.51 -3.26,12.18 -3.19,10.73 -3.13,9.27 -3.04,7.89 -2.95,6.52 -2.87,5.44 -2.80,4.36 -2.72,3.23 -2.65,2.10 -2.61,1.05 -2.58,0 -2.55,-0.30 -2.51,-0.61 -2.40,-0.91 -2.29,-1.20 -2.11,-1.45 -1.93,-1.71 -1.70,-1.92 -1.47,-2.13 -1.19,-2.27 -0.91,-2.42 -0.61,-2.49 -0.31,-2.56 0.00,-2.56 0.31,-2.56 0.61,-2.49 0.91,-2.42 1.19,-2.27 1.47,-2.13 1.70,-1.92 1.93,-1.71 2.11,-1.45 2.29,-1.20 2.40,-0.91 2.51,-0.61 2.55,-0.30 2.58,0.00 2.58,0.00 L 2.58,0 Z"></path></g><g transform="translate(197.7967002534756 780.0834271599076) rotate(0 11.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">T1</text></g><g transform="translate(341.5467002534756 778.8334271599076) rotate(0 15.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">T2</text></g><g stroke-linecap="round"><g transform="translate(206.54669598180953 569.9861936955872) rotate(0 -66.66666666666674 -209.16666666666669)"><path d="M0 0 C-40.91 -128.36, -81.82 -256.72, -133.33 -418.33 M0 0 C-50.26 -157.68, -100.51 -315.36, -133.33 -418.33" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(206.54669598180953 569.9861936955872) rotate(0 -66.66666666666674 -209.16666666666669)"><path d="M-115 -394.59 C-120.62 -401.88, -126.25 -409.16, -133.33 -418.33 M-115 -394.59 C-121.91 -403.54, -128.82 -412.49, -133.33 -418.33" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(206.54669598180953 569.9861936955872) rotate(0 -66.66666666666674 -209.16666666666669)"><path d="M-134.55 -388.36 C-134.18 -397.56, -133.8 -406.75, -133.33 -418.33 M-134.55 -388.36 C-134.09 -399.66, -133.63 -410.95, -133.33 -418.33" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(228.21336264847605 656.6528603622539) rotate(0 65 -263.33333333333337)"><path d="M0 0 C27.99 -113.38, 55.97 -226.75, 130 -526.67 M0 0 C32.01 -129.7, 64.03 -259.39, 130 -526.67" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(228.21336264847605 656.6528603622539) rotate(0 65 -263.33333333333337)"><path d="M133.21 -496.84 C132.52 -503.26, 131.83 -509.68, 130 -526.67 M133.21 -496.84 C132.42 -504.18, 131.63 -511.53, 130 -526.67" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(228.21336264847605 656.6528603622539) rotate(0 65 -263.33333333333337)"><path d="M113.28 -501.76 C116.88 -507.12, 120.48 -512.48, 130 -526.67 M113.28 -501.76 C117.4 -507.89, 121.52 -514.03, 130 -526.67" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(344.88002931514256 528.3195270289204) rotate(0 -100 -120)"><path d="M0 0 C-59.18 -71.02, -118.36 -142.03, -200 -240 M0 0 C-72.42 -86.91, -144.85 -173.82, -200 -240" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(344.88002931514256 528.3195270289204) rotate(0 -100 -120)"><path d="M-174.07 -224.91 C-181.74 -229.38, -189.42 -233.84, -200 -240 M-174.07 -224.91 C-183.46 -230.38, -192.85 -235.84, -200 -240" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(344.88002931514256 528.3195270289204) rotate(0 -100 -120)"><path d="M-189.84 -211.77 C-192.84 -220.13, -195.85 -228.48, -200 -240 M-189.84 -211.77 C-193.52 -222, -197.2 -232.22, -200 -240" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(216.54669598180953 694.9861936955872) rotate(0 200.83333333333326 -256.6666666666667)"><path d="M0 0 C132.08 -168.8, 264.16 -337.6, 401.67 -513.33 M0 0 C97.52 -124.63, 195.04 -249.26, 401.67 -513.33" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(216.54669598180953 694.9861936955872) rotate(0 200.83333333333326 -256.6666666666667)"><path d="M392.38 -484.81 C395.43 -494.19, 398.49 -503.57, 401.67 -513.33 M392.38 -484.81 C394.63 -491.73, 396.89 -498.66, 401.67 -513.33" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(216.54669598180953 694.9861936955872) rotate(0 200.83333333333326 -256.6666666666667)"><path d="M376.21 -497.45 C384.58 -502.68, 392.95 -507.9, 401.67 -513.33 M376.21 -497.45 C382.39 -501.31, 388.57 -505.16, 401.67 -513.33" stroke="#000000" stroke-width="1" fill="none"></path></g></g><g stroke-linecap="round"><g transform="translate(361.54669598180953 616.6528603622539) rotate(0 134.16666666666652 -215.83333333333337)"><path d="M0 0 C70.21 -112.95, 140.42 -225.9, 268.33 -431.67 M0 0 C99.28 -159.72, 198.57 -319.44, 268.33 -431.67" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(361.54669598180953 616.6528603622539) rotate(0 134.16666666666652 -215.83333333333337)"><path d="M262.16 -402.31 C263.78 -409.99, 265.39 -417.67, 268.33 -431.67 M262.16 -402.31 C264.45 -413.17, 266.73 -424.03, 268.33 -431.67" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(361.54669598180953 616.6528603622539) rotate(0 134.16666666666652 -215.83333333333337)"><path d="M244.74 -413.14 C250.91 -417.99, 257.09 -422.84, 268.33 -431.67 M244.74 -413.14 C253.47 -420, 262.2 -426.85, 268.33 -431.67" stroke="#000000" stroke-width="1" fill="none"></path></g></g></svg>

由此引出Java的一个一般设计原则——对象默认可见。如果我有一个对象的引用，就可以复制一个副本，让后将其交给另一个线程，不受任何限制。Java中的引用其实就是类型指针，指向内存中的一个位置，而且所有线程都共用一个地址空间，所以默认可见符合自然规律。

除了默认可见之外，Java还有一个特性对理解并发很重要——对象是可变的（mutable），对象的内容（实例字段的值）一般都可以修改。使用 final 关键字可以把变量或引用声明为常量，但这种字段不属于对象的内容。

这两个特性（跨线程可见性和对象可变性）结合在一起，大大增加了理解Java并发编程的难度。

如果我们想编写正确的多线程代码，得让程序满足一个重要的条件，即：

>在一个程序中，不管调用什么方法，也不管操作系统如何调度应用线程，一个对象看到的任何其他对象都不能处于非法或不一致的状态，这样的程序才称得上是安全的多线程程序。

在前面，我们把安全的面向对象程序定义为，通过调用对象的存取方法，把对象从一个合法状态变成另一个合法状态。这个定义对单线程代码来说没问题，但延伸到并发程序，会遇到一个特别的难题。

在大多数主流场合中，操作系统会根据负载和系统中运行的其他程序作出决策，在不同的时期把线程调度到不同的处理器内核中运行。如果负载高，说明还有其他进程需要运行。

如果需要，操作系统会把Java线程从CPU内核中强制移出，不管线程正在做什么，哪怕某个方法正执行一半，都会立即挂起。可是，之前说过，在方法执行的过程中，可以临时先把对象变成非法状态，等方法退出后再变成合法状态。

因此，即便程序遵守了安全规则，如果一个长时间运行的方法还没退出线程就被踢出了，也可能会让对象处于不一致状态。也就是说，虽然为单线程正确建模了数据类型，但还是要考虑如何避免并发的影响。添加这层额外的保护措施之后，才能称为并发安全的代码。

# 互斥机制和保护状态

只要修改或读取对象的过程中，对象的状态可能不一致，这段代码就要受到保护。为了保护这种代码，Java平台只提供了一种机制：互斥。

假如一个方法包含一连串操作，那么在执行过程中中断，就可能会导致某个对象处于不一致或非法状态。如果这个非法状态对另一个对象可见，代码的行为可能就会错乱。

例如，在ATM或者其他柜员机的系统中可能有如下代码：

```java
public class Account {
	private double balance = 0.0;    //必须大于等于0
	//假设还有其他字段，例如name，以及其他方法
	public Account(double openingBal) {
		balance = openingBal;
	}
	public boolean withdraw(double amount) {
		if(balance >= amount) {
			try {
				Thread.sleep(2000);    //模拟风险检查
			} catch(InterruptedException e) {
				return false;
			}
			balance = balance - amout;
			dispenseNotes(amount);    //是这个类中的一个方法
			return true;
		}
		return false;
	}
}
```

`withdraw()` 方法中的一连串操作就可能会让对象处于不一致状态。具体来说是这样的：查看余额之后，在模拟风险检查阶段，第一个线程休眠时，可能会出现第二个线程继续执行代码，导致账户透支，违背 `balance >= 0` 这个约束条件。

在这个例子中，系统对对象的操作虽然在单线程中安全（因为在单线程中对象不可能变成非法状态，即 `balance < 0` ），但并发时却不安全。

为了让这种代码在并发运行时也安全，Java为开发者提供了 synchronized 关键字。这个关键字可以用在代码块或方法上，使用时，Java平台会限制访问代码块或方法中的代码。

tip：因为 synchronized 关键字把代码包围起来，所以很多开发者认为，Java的并发和代码有关。有些资料甚至把 synchronized 修饰的块或方法中的代码称为临界区，还认为临界区是并发的关键所在。其实不然，我们要防范的是数据的不一致性。

Java平台会为它创建的每个对象记录一个特殊的标记，这个标记叫监视器（monitor）。synchronized使用这些监视器（或叫锁）指明，随后的代码可以临时把对象渲染成不一致的状态。synchronized修饰的代码块或方法会发生一系列事件，详述如下：
+ 线程需要修改对象时，会临时把对象变成不一致状态；
+ 线程获取监视器，指明它需要临时互斥存储这个对象；
+ 线程修改对象，修改完毕后对象处于一致的合法状态；
+ 线程释放监视器。

如果在修改对象的过程中，其他线程尝试获取锁，Java会阻塞这次尝试，直到拥有锁的线程释放锁为止。

注意，如果程序没有创建共享数据的多个线程，就无需使用synchronized语句。如果自始至终只有一个线程访问某个数据结构，就无需使用synchronized保护这个结构。

获取监视器不能避免访问对象，只能避免其他线程声称拥有这个锁——这一点至关重要。为了正确编写并发安全的代码，开发者要确保，修改或读取可能处于不一致状态的对象之前，得先获取对象的监视器。

换个角度来说，如果synchronized修饰的方法正在处理一个对象，并且把这个对象变成非法状态，那么读取这个对象的另一个方法（没有使用synchronized修饰）仍能看到这个不一致的状态。

tip：同步是保护状态的一种协助机制，因此非常脆弱。一个缺陷（需要使用synchronized修饰的方法却没有使用）就可能为系统的整体安全性带来灾难性的后果。

之所以使用synchronized这个词作为“需要临时互斥存储”的关键字，除了说明需要获取监视器之外，还表明进入代码块时，JVM会从主存中重新读取对象的当前状态。类似地，退出synchronized修饰的代码块或方法时，JVM会刷新所有修改过的对象，把新状态存入主内存。

如果不同步，系统中不同的CPU内核看到的内存状态可能不一样，而这种差异可能会破坏运行中程序的状态。前面的ATM示例就可能出现这种情况。

# volatile

Java还提供了另一个关键字，用来并发访问数据—— `volatile` 。这个关键字指明，应用代码使用字段或变量前，必须重新从主存读取值。同样，修改使用 volatile 修饰的值后，在写入变量之后，必须存回主存。

volatile关键字的主要用途之一是在“关闭前一直运行”模式中使用。编写多线程程序时，如果外部用户或系统需要向处理中的线程发出信号，告诉线程在完成当前作业后优雅关闭线程，那么就要使用volatile。这个过程有时叫做“优雅结束”模式。

下面看一个典型示例，假设处理中的线程里有下述代码，而这段代码在一个实现Runnable接口的类中定义：

```java
private volatile boolean shutdown = false;

public void shutdown() {
	shutdown = true;
}

public void run() {
	while(!shutdown) {
		//处理其他任务
	}
}
```

只要没有其他线程调用 `shutdown()` 方法，处理中的线程就会继续处理任务（经常和非常有用的 `BlockingQueue` 一起使用，BlockingQueue接口用于分配工作）。一旦有其他线程调用 `shutdown()` 方法，处理中的线程就会发现 shutdown 的值变成了 true。这个变化并不影响运行中的作业，不过一旦这个任务结束，处理中的线程就不会再接受其他任务，而会优雅关闭。

# `Thread` 类的实用方法

创建新应用线程时，程序员可以使用 Thread 类中的许多方法，减少劳动量。

## `getId()` 方法

这个方法返回线程的ID值，类型为long。线程的ID在线程的整个生命周期中都不变。

## `getPriority()` 方法和 `setPriority()` 方法

这两个方法控制线程的优先级。调度程序处理线程优先级的策略之一是，如果有优先级高的线程在等待，就不运行优先级低的线程。不过，大多数情况下都无法影响调度程序解释优先级的方式。线程的优先级使用1~10之间的整数表示。

## `setName()` 方法和 `getName()` 方法

开发者使用这两个方法设定或取回单个线程的名称。为线程起名字是个好习惯，因为这样调试时更方便，尤其是使用 jvisualvm 等工具。

## `getState()` 方法

返回一个 Thread.State 对象，说明线程处于什么状态。

## `isAlive()` 方法

用来测试线程是否还“活着”。

## `start()` 方法

这个方法用来创建一个新应用线程，然后再调用 `run()` 方法调度这个线程，开始执行。正常情况下，执行到 `run()` 方法的末尾或者执行 `run()` 方法中的一个 return 语句后，线程就会结束运行。

## `interrupt()` 方法

如果调用 `sleep()` `wait()` 或 `join()` 方法时阻塞了某个线程，那么在表示这个线程的 Thread 对象上调用 `interrupt()` 方法，会让这个线程抛出 InterruptedException 异常（并把线程唤醒）。如果线程中涉及可中断的I/O操作，那么这个I/O操作会终止，而且线程会收到 ClosedByInterruptException 异常。即便线程没有从事任何可中断的操作，线程的中断状态也会被设为true。

## `join()` 方法

在调用 `join()` 方法的Thread对象“死亡”之前，当前线程一直处于等待状态。可以把这个方法理解为一个指令，在其他线程结束之前，当前线程不会继续向前运行。

## `setDaemon()` 方法

用户线程是这样一种线程，只要它还“活着”，进程就无法退出——这是线程的默认行为。有时，程序员希望线程不阻止进程退出——这种线程叫守护线程。一个线程是守护线程还是用户线程，由 `setDaemon()` 方法控制。

## `setUncaughtExceptionHandler()` 方法

线程因抛出异常而退出时，默认的行为是打印线程的名称、异常的类型、异常消息和堆栈跟踪。如果这么做还不够，可以在线程中安装一个自定义的处理程序，处理未捕获的异常。例如：

```java
//这个线程直接抛出一个异常
Thread handledThread = new Thread(() -> {throw new UnsupportedOperationException();});

//给这个线程起一个名字，方便调试
handledThread.setName("my t1");

//处理这个异常的处理程序
handledThread.setUncaughtExceptionHandler((t,e) -> {
	System.err.printf("Exception in thread %d '%s':" +
		"%s at line %d of %s%n",
		t.getId(),    //线程的ID
		t.getName(),    //线程的名称
		e.toString(),    //异常名称和消息
		e.getStackTrace()[0].getLineNumber(),
		e.getStackTrace()[0].getFileName()
	);
});
handledThread.start();
```

这个方法在某些情况下很有用，例如，如果一个线程在监管一组其他工作线程，那么可以使用这种模式重启“死亡”的线程。

Thread类除了有一些有用的方法之外，还有一些危险的方法，开发者不应该使用。这些方法是Java线程API原来提供的，但很快就发现不适合开发者使用。可惜的是，因为Java要向后兼容，所以不能把这些方法从API中移除。开发者要只要有这些方法，而且在任何情况下都不能使用。

## ⊗ `stop()` 方法

如若不违背并发安全的要求，几乎不可能正确使用 `Thread.stop()` ，因为 `stop()` 方法会立即“杀死”线程，不给线程任何机会把对象恢复成合法状态。这和并发安全等原则完全相悖，因此绝对不能使用 `stop()` 方法。

## ⊗ `suspend()` 方法 、`resume()` 方法和 `countStackFrames()` 方法

调用 `suspend()` 方法挂起线程时，不会释放这个线程拥有的任何一个监视器，因此，如果其他线程试图访问这些监视器，这些监视器会变成死锁。其实，这种机制会导致死锁之间的条件竞争，而且 `resume()` 会导致这几个方法不能使用。

## ⊗ `destroy()` 方法

这个方法一直没有实现，如果实现了，会遇到与 `suspend()` 方法一样的条件竞争。

开发者始终应该避免使用这些弃用的方法。为了达到上述方法的预期作用，Java开发了一些安全的替代模式。前面提到的“关闭前一直运行”模式就是这些模式的一例。

# 使用线程

若想有效使用多线程代码，要对监视器和锁有些基本的认识。你需要知道的要点如下：
+ 同步是为了保护对象的状态和内存，而不是代码。
+ 同步是线程间的协助机制。一个缺陷就可能破坏这种协助模型，导致严重的后果。
+ 获取监视器只能避免其他线程再次获取这个监视器，而不能保护对象。
+ 即便对象的监视器锁定了，不同步的方法也能看到（和修改）不一致的状态。
+ 锁定 `Object[]` 不会锁定其中的单个对象。
+ 基本类型的值不可变，因此不能（也无需）锁定。
+ 接口中声明的方法不能使用 synchronized 修饰。
+ 内部类只是语法糖，因此内部类的锁对外层类无效（反过来亦然）。
+ Java的锁可重入（reentrant）。这意味着，如果一个线程拥有一个监视器，这个线程遇到具有同一个监视器的同步代码块时，可以进入这个代码块。（tip：除了Java，其他语言实现的锁并不都有这种特性。）

之前还提到过，线程可以休眠一段时间。但有时不需要指定具体休眠多久，而是等到满足某个条件时才唤醒。在Java中，这种操作通过 `wait()` 和 `notify()` 方法完成，这两个方法都在Object类中定义。

就像每个Java对象都关联一个锁一样，每个对象还会维护一个等待线程列表。在一个线程中，如果某个对象调用了 `wait()` 方法，那么这个线程会临时释放它拥有的所有锁，而且这个线程会被添加到这个对象的等待线程列表中，然后停止运行。其他线程在这个对象上调用 `notifyAll()` 方法时，这个对象会唤醒等待线程，让这些线程继续运行。

例如，下面是一个简化版队列，在多线程环境中可以安全使用：

```java
/*
	一个线程调用 push() 方法，把一个对象存入队列
	另一个线程调用 pop() 方法，从队列中取出一个对象
	如果队列中没有数据， pop() 方法使用 wait()/notify()，一直等待，直到有数据
*/
public class WaitingQueue<E> {
	LinkedList<E> q = new LinkedList<E>();    //作为仓库使用
	public synchronized void push(E o) {
		q.add(o);
		notifyAll();
	}
	public synchronized E pop() {
		while(q.size() == 0) {
			try {
				wait();
			} catch (InterruptedException e) {
			
			}
		}
		return q.remove();
	}
}
```

这个类在队列为空时（此时 pop() 操作会失败），在 WaitingQueue 实例上调用 wait() 方法。等待的线程会临时释放监视器，允许其他线程声称拥有这个监视器，然后这个线程可能会调用 push() 方法，把新对象添加到队列中。原来的线程被唤醒时，会从它之前开始休眠的地方继续运行，而且会重新获取监视器。

一般来说，大多数开发者都不需要自己编写类似这个示例的类，使用Java平台提供的库和组件即可。

tip： `wait()` 和 `notify()` 方法必须在synchronized修饰的方法或代码块中使用，因为只有临时把锁放弃，这两个方法才能正常工作。
