# Queue接口的概念

队列（queue）是一组有序的元素，提取元素时按顺序从队头读取。队列一般按照插入元素的顺序实现，因此分为两类：先进先出（first-in,first-out,FIFO）队列和后进先出（last-in,first-out,LIFO）队列。

tip：LIFO队列也叫栈（stack），Java提供了Stack类，但强烈不建议使用——应该使用实现 `Deque` 接口的类。

队列也可以使用其他顺序：
+ 优先队列（priority queue），根据外部 `Comparator` 对象或 `Comparable` 类型元素的自然顺序排序元素。与 `Set` 不同的是， `Queue` 的实现往往允许出现重复的元素。而与 `List` 不同的是， `Queue` 接口没有定义处理任意索引位元素的方法，只有队列的头一个元素能访问。 `Queue` 的所有实现都要具有一个固定的容量：队列已满时，不能再添加元素。类似地，队列为空时，不能再删除元素。很多基于队列的算法都会用到“满”和“空”这两个状态，所以 `Queue` 接口定义的方法通过返回值表明这两个状态，而不会抛出异常。具体而言， `peek()` 和 `poll()` 方法返回 `null` 表示队列为空。因此，多数 `Queue` 接口的实现不允许使用 `null` 作为元素。
+ 阻塞式队列（blocking queue），是一种定义了阻塞式 `put()` 和 `take()` 方法的队列。 `put()` 方法的作用是把元素添加到队列中，如果需要，这个方法会一直等待，直到队列中有存储元素的空间为止。而 `take()` 方法的作用是从队头移除元素，如果需要，这个方法会一直等待，直到队列中有元素可供移除为止。阻塞式队列是很多多线程算法的重要组成部分，因此 `BlockingQueue` 接口（扩展 `Queue` 接口）在 `java.util.concurrent` 包中定义。

队列不像集、列表和映射那么有用，只在特定的多线程编程风格中会用到。这里，我们不举实例，而是试着理清一些令人困惑的队列插入和移除操作。

# 添加元素

## `add()` 方法

这个方法在 `Collection` 接口中定义，只是使用常规的方式添加元素。对有界的队列来说，如果队列已满，这个方法可能会抛出异常。

## `offer()` 方法

个方法在 `Queue` 接口中定义，但是由于有界队列已满而无法添加元素时，这个方法返回 `false` ，而不会抛出异常。在 `BlockingQueue` 接口中定义了一个超时版的 `offer()` 方法，如果队列已满，会在指定的时间内等待空间。这个版本和基本版一样，成功插入元素时返回 `true` ，否则返回 `false` 。

## `put()` 方法

这个方法在 `BlockingQueue` 接口中定义，会阻塞操作：如果因为队列已满而无法插入元素， `put()` 方法会一直等待，直到其他线程从队列中移除元素，有空间插入新元素为止。

# 移除元素

## `remove()` 方法

`Collection` 接口中定义了 `remove()` 方法，把指定的元素从队列中移除。除此之外， `Queue` 接口还定义了一个没有参数的 `remove()` 方法，移除并返回队头的元素。如果队列为空，这个方法会抛出 `NoSuchElementException` 异常。

## `poll()` 方法

这个方法在 `Queue` 接口中定义，作用和 `remove()` 方法类似，移除并返回队头的元素，不过，如果队列为空，这个方法会返回 `null` ，而不抛出异常。 `BlockingQueue` 接口定义了一个超时版的 `poll()` 方法，在指定的时间内等待元素添加到空队列中。

## `take()` 方法

这个方法在 `BlockingQueue` 接口中定义，用于删除并返回队头的元素。如果队列为空，这个方法会等待，直到其他线程把元素添加到队列中为止。

## `drainTo()` 方法

这个方法在 `BlockingQueue` 接口中定义，作用是把队列中的所有元素都移除，然后把这些元素添加到指定的 `Collection` 对象中。这个方法不会阻塞操作，等待有元素添加到队列中。这个方法有个变体，接受一个参数，指定最多移除多少个元素。

# 访问队头元素

## `element()` 方法

这个方法在 `Queue` 接口中定义，其作用是返回队头的元素，但不将其从队列中移除。如果队列为空，这个方法抛出 `NoSuchElementException` 异常。

## `peek()` 方法

这个方法在 `Queue` 接口中定义，作用和 `element()` 方法类似，但队列为空时，返回 `null` 。

tip：使用队列时，最好选定一种处理失败的方式。例如，如果想在操作成功之前一直阻塞，应该选择 `put()` 和 `take()` 方法；如果想检查方法的返回值，判断操作是否成功，应该选择 `offer()` 和 `poll()` 方法。

`LinkedList` 类也实现了 `Queue` 接口，提供的是无界的FIFO顺序，插入和移除操作需要常数时间。 `LinkedList` 对象可以使用 `null` 作为元素，不过，当列表用作队列时不建议使用 `null` 。

`java.util` 包中还有另外两个 `Queue` 接口的实现。一个是 `PriorityQueue` 类，这种队列根据 `Comparator` 对象排序元素，或者根据 `Comparable` 类型元素的 `compareTo()` 方法排序元素。 `PriorityQueue` 对象的队头始终是根据指定排序方式得到的最小值。另外一个是 `ArrayDeque` 类，实现的是双端队列，一般在需要用到栈的情况下使用。

`java.util.concurrent` 包中也包含一些 `BlockingQueue` 接口的实现，目的是在多线程编程环境中使用。有些实现很高级，甚至无需使用同步方法。
